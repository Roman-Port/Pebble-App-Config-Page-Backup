fourSq.map.BoundEvent=function(a,b,c,d){this.map_=a;this.eventName_=b;this.callback_=c;this.context_=d;this.isCanceled=!1};fourSq.map.BoundEvent.prototype.cancel=function(){this.isCanceled||(this.map_.off(this.eventName_,this.callback_,this.context_),this.isCanceled=!0)};fourSq.map.EventHelper={on:function(a,b,c,d){a.on(b,c,d);return new fourSq.map.BoundEvent(a,b,c,d)},off:function(a,b,c,d){return a.off(b,c,d)},onOnce:function(a,b,c,d){var e=null,f=function(){e&&e.cancel();c.apply(this,arguments)},e=new fourSq.map.BoundEvent(a,b,f,d);a.on(b,f,d);return e}};fourSq.map.EventedControl=L.Control.extend({initialize:function(){L.Control.prototype.initialize.apply(this,arguments);this.eventTarget=new fourSq.EventTarget},trigger:function(a,b){var c=Array.prototype.slice.call(arguments,1);return this.eventTarget.trigger(a,c)},on:function(a,b,c){return this.eventTarget.on(a,b,c)}});fourSq.map.EventedZoomControl=function(a,b){};
fourSq.map.EventedZoomControl=fourSq.map.EventedControl.extend({options:{position:"topleft"},onAdd:function(a){this.$container_=$(templates.fourSq.map.controls.zoom.control());this.zoomInButton_=this.$container_.find(".leaflet-control-zoom-in");this.zoomOutButton_=this.$container_.find(".leaflet-control-zoom-out");a=function(a){a.preventDefault();a.stopPropagation()};this.zoomInButton_.dblclick(a).click(a).click(fourSq.bind(this.handleZoomIn_,this));this.zoomOutButton_.dblclick(a).click(a).click(fourSq.bind(this.handleZoomOut_,this));
return this.getContainer()},getContainer:function(){return this.$container_.get(0)},handleZoomIn_:function(){this.trigger(fourSq.map.EventedZoomControl.Events.ZOOM_IN)},handleZoomOut_:function(){this.trigger(fourSq.map.EventedZoomControl.Events.ZOOM_OUT)}});fourSq.map.EventedZoomControl.Events={ZOOM_IN:"ZOOM_IN",ZOOM_OUT:"ZOOM_OUT"};fourSq.map.LeafletUtil={latLngToContainerPoint:function(a,b){return a.layerPointToContainerPoint(a.latLngToLayerPoint(b))},getContainer:function(a){return a._container},getPopupContentNode:function(a){return a._contentNode},pointToSize:function(a){return{width:a.x,height:a.y}},expandMapBounds:function(a,b){return new L.LatLngBounds(new L.LatLng(Math.min(a.getSouthWest().lat,b.getSouthWest().lat),Math.min(a.getSouthWest().lng,b.getSouthWest().lng)),new L.LatLng(Math.max(a.getNorthEast().lat,b.getNorthEast().lat),
Math.max(a.getNorthEast().lng,b.getNorthEast().lng)))},setViewEnsureEvents:function(a,b,c){var d=a.getCenter(),e=a.getZoom(),f=fourSq.api.models.companion.geo.LatLngUtil.fromLeaflet(b),d=fourSq.api.models.companion.geo.LatLngUtil.fromLeaflet(d);fourSq.api.models.companion.geo.LatLngUtil.equals(f,d,3)&&e===c?(a.fire("movestart"),a.fire("moveend")):a.setView(b,c)},setZoomEnsureEvents:function(a,b){a.getZoom()==b?(a.fire("zoomstart"),a.fire("zoomend")):a.setZoom(b)},fitBoundsEnsureEvents:function(a,
b){var c=a.getBoundsZoom(b);fourSq.map.LeafletUtil.setViewEnsureEvents(a,b.getCenter(),c)},Events:{DRAW_CREATED:"draw:created",DRAW_EDITED:"draw:edited",DRAW_DRAWSTART:"draw:drawstart"}};fourSq.map.MapGenerator={setupTileLayer_:function(a,b){var c=a._addTilesFromCenterOut;a._addTilesFromCenterOut=function(a){c.call(this,b(a))};var d=a._removeOtherTiles;a._removeOtherTiles=function(a){d.call(this,b(a))}},generate:function(a,b,c){var d,e,f;b=b||{};c=c||{noAttribution:!1,withLegalAndPrivacyAttribution:!1,planet:void 0,getTilePadding:void 0,tilePadding:void 0,lang:void 0,noLabels:void 0,enableSatelliteLayer:!1,startInSatelliteMode:!1,layerControlsPosition:void 0};if(c.planet&&c.planet!==
fourSq.api.models.companion.venue.Planets.EARTH)d=helpers.map.baseUrl()+"foursquare.mars-composite/{z}/{x}/{y}.png",e=fourSq.map.MapGenerator.marsMaxZoom();else{d=c.lang||fourSq.i18n.browserPref();var g=0===d.indexOf("en")?"map-ikj05elx":"11ne79d5";fourSq.config.customMap&&(g=0===d.indexOf("en")?"01566faf":"qhb8olxr");f=c.noLabels?fourSq.map.MapGenerator.MapIds.NO_LABELS:g;d=helpers.map.baseUrl()+"foursquare."+f+"/{z}/{x}/{y}.png";e=fourSq.map.MapGenerator.maxZoom()}d=new L.TileLayer(d,{maxZoom:e});
g=function(a){var b,d=c.getTilePadding&&c.getTilePadding()||c.tilePadding||{};b=_.extend({top:0,right:0,bottom:0,left:0},d);d=new L.Point(a.min.x-b.left,a.min.y-b.bottom);a=new L.Point(a.max.x+b.right,a.max.y+b.top);return new L.Bounds(d,a)};fourSq.map.MapGenerator.setupTileLayer_(d,g);var h={layers:d,attributionControl:null,maxZoom:e,minZoom:1,keyboard:!1},l=L.Map.prototype.setView;L.Map.prototype.setView=function(a,b){b>=e?$(this._container).find(".leaflet-control-zoom-in").addClass("disabled"):
$(this._container).find(".leaflet-control-zoom-in").removeClass("disabled");0>=b?$(this._container).find(".leaflet-control-zoom-out").addClass("disabled"):$(this._container).find(".leaflet-control-zoom-out").removeClass("disabled");return l.apply(this,arguments)};var m;c.enableSatelliteLayer&&(m=helpers.map.baseUrl()+"foursquare.h4p4omim/{z}/{x}/{y}.png",m=new L.TileLayer(m,{maxZoom:e}),fourSq.map.MapGenerator.setupTileLayer_(m,g),c.startInSatelliteMode&&(h.layers=m));var q=new L.Map(a,_.extend(h,
b));q.generatedTileLayer=d;m&&(q.generatedSatelliteLayer=m,"none"!==c.layerControlsPosition&&(a={},a[helpers.map.mapViewLabel()]=d,a[helpers.map.satelliteViewLabel()]=m,L.control.layers(a,null,{collapsed:!1,autoZIndex:!0,position:c.layerControlsPosition||"topright"}).addTo(q)));c.noAttribution||(a=new L.Control.Attribution,c.withLegalAndPrivacyAttribution?a.setPrefix(helpers.map.attributionWithTermsAndPrivacy()):a.setPrefix(helpers.map.attribution()),q.addControl(a),$(".mapbox-improve-map").click(function(a){var b=
q.getCenter(),b="#foursquare."+f+"/"+b.lng.toFixed(3)+"/"+b.lat.toFixed(3)+"/"+q.getZoom();$(a.currentTarget).prop("href","https://www.mapbox.com/map-feedback/"+b);return!0}));return q},generateForVenue:function(a,b,c,d){var e,f,g=a.location&&a.location.planet||fourSq.api.models.companion.venue.Planets.EARTH;g!==fourSq.api.models.companion.venue.Planets.EARTH?(f=fourSq.map.MapGenerator.marsDefaultZoom(),e=new L.LatLng(a.location.astralLat,a.location.astralLng),a={icon:new fourSq.map.icon.RoverIcon,
zIndex:5E3}):(f=c.fuzzy?13:15,e=void 0,e=c.lat&&c.lng?new L.LatLng(c.lat,c.lng):new L.LatLng(a.location.lat,a.location.lng),a={zIndex:5E3});d=_.extend({zoom:c.animate?f:f+1,center:e},d||{});var h=fourSq.map.MapGenerator.generate(b,d,{planet:g});c.checkinLats&&c.checkinLongs&&c.checkinAccs&&fourSq.maps.Utils.addMarkersToMap(h,c.checkinLats,c.checkinLongs,c.checkinAccs,fourSq.maps.Utils.blueDots);c.fuzzy||h.addLayer(new L.Marker(e,a));c.animate&&setTimeout(function(){h.setZoom(f+1)},800);return h},
marsMaxZoom:function(){return 8},marsDefaultZoom:function(){return 5},maxZoom:function(){return fourSq.config&&fourSq.config.map&&fourSq.config.map.MAX_ZOOM_LEVEL||19},noninteractiveOptions:function(){return{doubleClickZoom:!1,dragging:!1,keyboard:!1,scrollWheelZoom:!1,touchZoom:!1,zoomControl:!1}}};fourSq.map.MapGenerator.MapIds={NO_LABELS:"map-3ntucprk"};fourSq.map.MapUtil={EARTH_RADIUS_M:6371E3,fitToLatLngs:function(a,b,c){b=new L.LatLngBounds(b);a.fitBounds(b);c&&(c=fourSq.map.MapUtil.padMapBounds(a,c),a.fitBounds(c))},padMapBounds:function(a,b,c){var d=c||a.getBounds();c=a.latLngToLayerPoint(d.getSouthWest());d=a.latLngToLayerPoint(d.getNorthEast());c=new L.Point(c.x+b.left,c.y-b.bottom);b=new L.Point(d.x-b.right,d.y+b.top);c=a.layerPointToLatLng(c);a=a.layerPointToLatLng(b);return new L.LatLngBounds(c,a)},padBoundsByPercent:function(a,b){var c=
a.getCenter(),d=a.getNorthEast(),e=a.getSouthWest(),f=new L.LatLng(d.lat,e.lng),g=1-b.latPercent,h=1-b.lngPercent,e=fourSq.map.MapUtil.distanceBetween(f,e)/2,d=fourSq.map.MapUtil.distanceBetween(d,f)/2,f=fourSq.map.MapUtil.computeOffset(c,g*e,0),f=fourSq.map.MapUtil.computeOffset(f,h*d,90),c=fourSq.map.MapUtil.computeOffset(c,g*e,180),h=fourSq.map.MapUtil.computeOffset(c,h*d,-90);return new L.LatLngBounds(h,f)},computeOffset:function(a,b,c){var d=fourSq.map.MapUtil.degreesToRadians(a.lat);a=fourSq.map.MapUtil.degreesToRadians(a.lng);
c=fourSq.map.MapUtil.degreesToRadians(c);var e=b/fourSq.map.MapUtil.EARTH_RADIUS_M;b=Math.asin(Math.sin(d)*Math.cos(e)+Math.cos(d)*Math.sin(e)*Math.cos(c));d=a+Math.atan2(Math.sin(c)*Math.sin(e)*Math.cos(d),Math.cos(e)-Math.sin(d)*Math.sin(b));d=(d+3*Math.PI)%(2*Math.PI)-Math.PI;return new L.LatLng(fourSq.map.MapUtil.radiansToDegrees(b),fourSq.map.MapUtil.radiansToDegrees(d))},distanceBetween:function(a,b){var c=fourSq.map.MapUtil.degreesToRadians(a.lat),d=fourSq.map.MapUtil.degreesToRadians(b.lat),
e=fourSq.map.MapUtil.degreesToRadians(a.lng),f=fourSq.map.MapUtil.degreesToRadians(b.lng);return Math.acos(Math.sin(c)*Math.sin(d)+Math.cos(c)*Math.cos(d)*Math.cos(e-f))*fourSq.map.MapUtil.EARTH_RADIUS_M},midpoint:function(a,b){return new L.LatLng((a.lat+b.lat)/2,(a.lng+b.lng)/2)},radiusToBounds:function(a,b){var c=a.lng,d=b/fourSq.map.MapUtil.EARTH_RADIUS_M,e=fourSq.map.MapUtil.degreesToRadians(a.lat),f=fourSq.map.MapUtil.degreesToRadians(c),g=e+d,c=fourSq.map.MapUtil.radiansToDegrees(e-d),g=fourSq.map.MapUtil.radiansToDegrees(g),
e=Math.asin(Math.sin(d)/Math.cos(e)),d=f+e,f=fourSq.map.MapUtil.radiansToDegrees(f-e),d=fourSq.map.MapUtil.radiansToDegrees(d);return new L.LatLngBounds(new L.LatLng(c,f),new L.LatLng(g,d))},pixelOffsetToLatLng:function(a,b){return a.layerPointToLatLng(a.containerPointToLayerPoint(b))},degreesToRadians:function(a){return.0174532925*a},radiansToDegrees:function(a){return 57.2957795*a},calculateBearing:function(a,b){var c=fourSq.map.MapUtil.degreesToRadians(a.lat),d=fourSq.map.MapUtil.degreesToRadians(a.lng),
e=fourSq.map.MapUtil.degreesToRadians(b.lat),f=fourSq.map.MapUtil.degreesToRadians(b.lng)-d,d=Math.sin(f)*Math.cos(e),c=Math.cos(c)*Math.sin(e)-Math.sin(c)*Math.cos(e)*Math.cos(f);return fourSq.map.MapUtil.radiansToDegrees(Math.atan2(d,c))},boundsToUrlValue:function(a){return a.getSouthWest().lat+","+a.getSouthWest().lng+","+a.getNorthEast().lat+","+a.getNorthEast().lng}};fourSq.map.control.RequeryControl=function(a,b){};
fourSq.map.control.RequeryControl=fourSq.map.EventedControl.extend({options:{position:"topleft"},onAdd:function(a){this.$container_=$(templates.fourSq.explore.map.control.requery.control());this.$container_.find("a").click(function(a){a.preventDefault()});this.$container_.dblclick(function(a){a.preventDefault();a.stopPropagation()});this.$container_.click(fourSq.bind(function(a){this.handleClick_()},this));return this.getContainer()},getContainer:function(){return this.$container_.get(0)},startSpin:function(){this.$container_.addClass("spin")},
stopSpin:function(){this.$container_.removeClass("spin")},show:function(){this.$container_.show()},hide:function(){this.$container_.hide()},activate:function(){this.$container_.show().addClass("active").removeClass("inactive")},deactivate:function(){this.$container_.show().addClass("inactive").removeClass("active")},handleClick_:function(){this.trigger(fourSq.map.control.RequeryControl.Events.CLICK)}});fourSq.map.control.RequeryControl.Events={CLICK:"CLICK"};fourSq.map.icon.BlueDotIcon=L.Icon.extend({options:{iconUrl:"https://ss0.4sqi.net/img/map/blue-dot1-0ff549cde99f37c162b3404c7ff8eb6f.png",iconSize:new L.Point(10,10),iconAnchor:new L.Point(5,5),shadowUrl:null}});fourSq.map.icon.RedDotIcon=L.Icon.extend({options:{iconUrl:"https://ss0.4sqi.net/img/map/red-dot1-0ba6cd6a0ef77b8d6b1b7db53f723d04.png",iconSize:new L.Point(10,10),iconAnchor:new L.Point(5,5),shadowUrl:null}});fourSq.map.icon.RoverIcon=L.Icon.extend({options:{iconUrl:"https://ss1.4sqi.net/img/map/rover-1ae026af17c755fd5cc1e0945fbf20ca.png",iconSize:new L.Point(59,45),iconAnchor:new L.Point(29,22),shadowUrl:null}});fourSq.map.icon.PromotedIcon=L.Icon.extend({options:{iconUrl:fourSq.retina.isRetina()?"https://ss0.4sqi.net/img/blueBolt@2x-5a8a6006b4c334bf3218d4764d6b064c.png":"https://ss0.4sqi.net/img/blueBolt-f40b4cf7007d75f2a2333a7cb734b5f7.png",iconSize:new L.Point(38,48),iconAnchor:new L.Point(19,54),shadowUrl:null}});
fourSq.map.icon.SelectedPromotedIcon=L.Icon.extend({options:{iconUrl:fourSq.retina.isRetina()?"https://ss1.4sqi.net/img/whiteBolt@2x-cd5ec72f6484f0f4fb4c30472d20521c.png":"https://ss0.4sqi.net/img/whiteBolt-ae2673cc403024fe7d5eba64b2a19a28.png",iconSize:new L.Point(38,48),iconAnchor:new L.Point(19,54),shadowUrl:null}});fourSq.map.AsymmetricView=function(a){};
fourSq.map.AsymmetricView=fourSq.ui.View.extend({initialize:function(a){if(a.venue&&a.venue.location){var b=a.venue.location;this.canZoomMap_=a.canZoomMap;this.$map_=$(this.el);var c=this.$map_.attr("id")||_.uniqueId("map");this.$map_.attr("id",c);this.markerOffsetTop_=a.markerOffsetTop;this.markerOffsetCenterRight_=a.markerOffsetCenterRight;var d=b&&b.planet||fourSq.api.models.companion.venue.Planets.EARTH,e=d===fourSq.api.models.companion.venue.Planets.EARTH,f=e?16:5;b.isFuzzed&&e&&(f=10);this.lat_=
1*(e?b.lat:b.astralLat);this.lng_=1*(e?b.lng:b.astralLng);this.isOffCenter_=!0;this.map_=fourSq.map.MapGenerator.generate(c,fourSq.map.MapGenerator.noninteractiveOptions(),{planet:d});this.map_.setView(this.getOffsetLocation_(f),f,!0);a=new L.DivIcon({className:"mapMarker",html:helpers.pin.pinBigCategory({venue:a.venue}),iconAnchor:new L.Point(35,86),iconSize:new L.Point(92,92)});this.marker_=new L.Marker(new L.LatLng(this.lat_,this.lng_),{icon:a,clickable:this.canZoomMap_});this.marker_.addTo(this.map_)}},
decorate:function(){$(window).on("resize orientationChanged",fourSq.bind(function(){this.updateMap_(!1,this.map_.getZoom())},this));var a=new fourSq.map.EventedZoomControl;this.map_.addControl(a);var b=fourSq.map.EventedZoomControl.Events;a.on(b.ZOOM_IN,fourSq.bind(this.zoomIn_,this));a.on(b.ZOOM_OUT,fourSq.bind(this.zoomOut_,this));this.$map_.on("dragstart",".leaflet-tile",function(){return!1});return this},zoomOut_:function(){var a=this.map_,b=a.getZoom();b>a.getMinZoom()&&this.updateMap_(!0,b-
1)},zoomIn_:function(){var a=this.map_,b=a.getZoom();b<a.getMaxZoom()&&this.updateMap_(!0,b+1)},updateMap_:function(a,b){this.isOffCenter_?this.offCenter(a,b):this.center(a,b)},getOffsetLocation_:function(a){var b=new L.LatLng(this.lat_,this.lng_),c=this.map_,d=this.getCenterOffset_(),b=c.project(b,a).add(d);return c.unproject(b,a)},getCenterOffset_:function(){var a=this.$map_.height()/2-this.markerOffsetTop_;return new L.Point(0-this.markerOffsetCenterRight_,a)},center:function(a,b){this.isOffCenter_=
!1;b=fourSq.isDefinedAndNotNull(b)?b:this.map_.getZoom();var c=new L.LatLng(this.lat_,this.lng_);this.map_.setView(c,b,!a)},offCenter:function(a,b){this.isOffCenter_=!0;b=fourSq.isDefinedAndNotNull(b)?b:this.map_.getZoom();var c=this.getOffsetLocation_(b);this.map_.setView(c,b,!a)}});"undefined"==typeof templates.fourSq&&(templates.fourSq={});"undefined"==typeof templates.fourSq.explore&&(templates.fourSq.explore={});"undefined"==typeof templates.fourSq.explore.map&&(templates.fourSq.explore.map={});"undefined"==typeof templates.fourSq.explore.map.control&&(templates.fourSq.explore.map.control={});"undefined"==typeof templates.fourSq.explore.map.control.requery&&(templates.fourSq.explore.map.control.requery={});templates.fourSq.explore.map.control.requery.control=function(a,b){return'\x3cdiv class\x3d"leaflet-control-requery"\x3e\x3ca href\x3d"#"\x3e\x3c/a\x3e\x3cspan\x3eSearch this area\x3c/span\x3e\x3c/div\x3e'};"undefined"==typeof templates.fourSq&&(templates.fourSq={});"undefined"==typeof templates.fourSq.map&&(templates.fourSq.map={});"undefined"==typeof templates.fourSq.map.controls&&(templates.fourSq.map.controls={});"undefined"==typeof templates.fourSq.map.controls.zoom&&(templates.fourSq.map.controls.zoom={});templates.fourSq.map.controls.zoom.control=function(a,b){return'\x3cdiv class\x3d"leaflet-control-zoom"\x3e\x3ca href\x3d"#" class\x3d"leaflet-control-zoom-in" title\x3d"Zoom in"\x3e\x3c/a\x3e\x3ca href\x3d"#" class\x3d"leaflet-control-zoom-out" title\x3d"Zoom out"\x3e\x3c/a\x3e\x3c/div\x3e'};"undefined"==typeof templates.fourSq&&(templates.fourSq={});"undefined"==typeof templates.fourSq.map&&(templates.fourSq.map={});"undefined"==typeof templates.fourSq.map.controls&&(templates.fourSq.map.controls={});"undefined"==typeof templates.fourSq.map.controls.draw&&(templates.fourSq.map.controls.draw={});templates.fourSq.map.controls.draw.control=function(a,b){return'\x3cdiv class\x3d"leaflet-control-draw"\x3e\x3cspan class\x3d"draw-control-button"\x3eDraw\x3c/span\x3e\x3c/div\x3e'};