<!DOCTYPE html>
<html lang='en'>
	<head>
		<meta charset='utf-8'><script type="text/javascript">window.NREUM||(NREUM={}),__nr_require=function(e,t,n){function r(n){if(!t[n]){var o=t[n]={exports:{}};e[n][0].call(o.exports,function(t){var o=e[n][1][t];return r(o||t)},o,o.exports)}return t[n].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<n.length;o++)r(n[o]);return r}({1:[function(e,t,n){function r(e,t){return function(){o(e,[(new Date).getTime()].concat(a(arguments)),null,t)}}var o=e("handle"),i=e(2),a=e(3);"undefined"==typeof window.newrelic&&(newrelic=NREUM);var u=["setPageViewName","setCustomAttribute","finished","addToTrace","inlineHit"],c=["addPageAction"],f="api-";i(u,function(e,t){newrelic[t]=r(f+t,"api")}),i(c,function(e,t){newrelic[t]=r(f+t)}),t.exports=newrelic,newrelic.noticeError=function(e){"string"==typeof e&&(e=new Error(e)),o("err",[e,(new Date).getTime()])}},{}],2:[function(e,t,n){function r(e,t){var n=[],r="",i=0;for(r in e)o.call(e,r)&&(n[i]=t(r,e[r]),i+=1);return n}var o=Object.prototype.hasOwnProperty;t.exports=r},{}],3:[function(e,t,n){function r(e,t,n){t||(t=0),"undefined"==typeof n&&(n=e?e.length:0);for(var r=-1,o=n-t||0,i=Array(0>o?0:o);++r<o;)i[r]=e[t+r];return i}t.exports=r},{}],ee:[function(e,t,n){function r(){}function o(e){function t(e){return e&&e instanceof r?e:e?u(e,a,i):i()}function n(n,r,o){e&&e(n,r,o);for(var i=t(o),a=l(n),u=a.length,c=0;u>c;c++)a[c].apply(i,r);var s=f[g[n]];return s&&s.push([m,n,r,i]),i}function p(e,t){w[e]=l(e).concat(t)}function l(e){return w[e]||[]}function d(e){return s[e]=s[e]||o(n)}function v(e,t){c(e,function(e,n){t=t||"feature",g[n]=t,t in f||(f[t]=[])})}var w={},g={},m={on:p,emit:n,get:d,listeners:l,context:t,buffer:v};return m}function i(){return new r}var a="nr@context",u=e("gos"),c=e(2),f={},s={},p=t.exports=o();p.backlog=f},{}],gos:[function(e,t,n){function r(e,t,n){if(o.call(e,t))return e[t];var r=n();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,t,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[t]=r,r}var o=Object.prototype.hasOwnProperty;t.exports=r},{}],handle:[function(e,t,n){function r(e,t,n,r){o.buffer([e],r),o.emit(e,t,n)}var o=e("ee").get("handle");t.exports=r,r.ee=o},{}],id:[function(e,t,n){function r(e){var t=typeof e;return!e||"object"!==t&&"function"!==t?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");t.exports=r},{}],loader:[function(e,t,n){function r(){if(!w++){var e=v.info=NREUM.info,t=s.getElementsByTagName("script")[0];if(e&&e.licenseKey&&e.applicationID&&t){c(l,function(t,n){e[t]||(e[t]=n)});var n="https"===p.split(":")[0]||e.sslForHttp;v.proto=n?"https://":"http://",u("mark",["onload",a()],null,"api");var r=s.createElement("script");r.src=v.proto+e.agent,t.parentNode.insertBefore(r,t)}}}function o(){"complete"===s.readyState&&i()}function i(){u("mark",["domContent",a()],null,"api")}function a(){return(new Date).getTime()}var u=e("handle"),c=e(2),f=window,s=f.document;NREUM.o={ST:setTimeout,CT:clearTimeout,XHR:f.XMLHttpRequest,REQ:f.Request,EV:f.Event,PR:f.Promise,MO:f.MutationObserver},e(1);var p=""+location,l={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-943.min.js"},d=window.XMLHttpRequest&&XMLHttpRequest.prototype&&XMLHttpRequest.prototype.addEventListener&&!/CriOS/.test(navigator.userAgent),v=t.exports={offset:a(),origin:p,features:{},xhrWrappable:d};s.addEventListener?(s.addEventListener("DOMContentLoaded",i,!1),f.addEventListener("load",r,!1)):(s.attachEvent("onreadystatechange",o),f.attachEvent("onload",r)),u("mark",["firstbyte",a()],null,"api");var w=0},{}]},{},["loader"]);</script>
		<meta name='viewport' content='width=device-width, initial-scale=1.0, user-scalable=0'>
		<title>Tinder for Pebble</title>
		<link href='/maxcdn.bootstrapcdn.com/bootswatch/3.3.0/darkly/bootstrap.css' rel='stylesheet'>
		<link href='/maxcdn.bootstrapcdn.com/font-awesome/4.2.0/css/font-awesome.css' rel='stylesheet'>
		<style>
			.container { margin: 5px 0px 20px; }
			.login { background-color: #f9f2f4; color: #c7254e; clear: both; text-align: center; margin-bottom: 0.9em; }
		</style>
	</head>

	<body>
		<div class='container'>

			<h4>Instructions for Logging In</h4>
			<div>
				<p>Logging in currently requires some extra steps. <i>(until I find a better way, sorry!)</i></p>
				<p><b>Read the instructions before proceeding.</b></p>
				<ul>
					<li>Go to the following URL in your phone's browser (Safari/Chrome) and log in to the same Facebook account you use with Tinder.</li>
					<li>Once logged in, quickly copy the URL and paste it in the box below. (tap the URL as soon as you see <b><i>success</i></b> on the screen)</li>
				</ul>
				<p>Make sure the URL you copy is the <i>login_success.html</i> page with an access token (tap the URL bar as soon as you see <b><i>success</i></b>) and not <i>blank.html</i>. If it already redirected to <i>blank.html</i> before you got to copy the URL, repeat the steps.</p>
				<pre class='login' onclick='selectText(this)' ontouch='selectText(this)'><code>https://www.facebook.com/dialog/oauth?scope=basic_info%2Cemail%2Cpublic_profile%2Cuser_about_me%2Cuser_activities%2Cuser_birthday%2Cuser_education_history%2Cuser_friends%2Cuser_interests%2Cuser_likes%2Cuser_location%2Cuser_photos%2Cuser_relationship_details&response_type=token&client_id=464891386855067&redirect_uri=https%3A%2F%2Fwww.facebook.com%2Fconnect%2Flogin_success.html</code></pre>
			</div>

			<br>

			<div class='alert alert-danger alert-dismissible' hidden='true' role='alert'>
				<button type='button' class='close' id='alert-close-button'><span aria-hidden='true'>&times;</span><span class='sr-only'>Close</span></button>
				Invalid URL. Please read the instructions and repeat the process again while making sure you are quick to copy the URL after logging in.
			</div>

			<div class='form-group'>
				<label for='url'>URL</label>
				<input type='text' class='form-control' id='url' autocorrect='off' autocapitalize='off' placeholder='https://www.facebook.com/connect/login_success.html#access_token=CAAVMZByCauEBYANyBZhmKrZB1tBPAZVZBu2wDa8AvqZBZCqqgX2kzZBIV1QXzHwfj&expires_in=7010'>
			</div>

			<button type='submit' class='btn btn-primary btn-block btn-save' id='save'>Save</button>

		</div>

		<script>(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,'script','//www.google-analytics.com/analytics.js','ga');ga('create','UA-50953610-1','ineal.me');ga('require','displayfeatures');ga('send','pageview');</script>
		<script src='/code.jquery.com//jquery-1.js'></script>
		<script src='/maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.js'></script>
		<script>
			$().ready(function() {
				$('#alert-close-button').click(function() {
					$(this).parent().hide();
				});
				$('#save').on('click', function() {
					var url = $('#url').val();
					try {
						var token = url.split('access_token=')[1];
						if (token.indexOf('&') > -1) token = token.split('&')[0];
					} catch (e) {
						$.ajax('/pebble/tinder/configuration/error?' + encodeURIComponent(url));
						return $('.alert').show();
					}
					var ret = {facebookToken: token};
					console.log(encodeURIComponent(JSON.stringify(ret)));
					document.location = '/pebble/tinder/api/success?' + encodeURIComponent(JSON.stringify(ret));
				});
			});
			function selectText(elem) {
				if (document.selection) {
					var range = document.body.createTextRange();
					range.moveToElementText(elem);
					range.select();
				} else if (window.getSelection) {
					var range = document.createRange();
					range.selectNode(elem);
					window.getSelection().addRange(range);
				}
			}
		</script>
	<script type="text/javascript">window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","licenseKey":"108b01b84d","applicationID":"2125246","transactionName":"NAcANRFTV0MABUALVg1NNxMKHUlVAwRYBxYXCwwFBkAWUw4IUgteFhADFQpdVx8ICFAHQU0SChE=","queueTime":0,"applicationTime":0,"atts":"GEADQ1lJRE0=","errorBeacon":"bam.nr-data.net","agent":""}</script></body>
</html>
