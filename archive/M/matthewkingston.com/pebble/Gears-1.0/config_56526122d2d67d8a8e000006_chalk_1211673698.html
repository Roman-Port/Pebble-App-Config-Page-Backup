<!DOCTYPE html>
<html>
<head>
<title>Gears 1.0</title>
<link rel="stylesheet" type="text/css" href="/matthewkingston.com/pebble/slate/dist/css/slate.css">
<script src="/matthewkingston.com/pebble/slate/dist/js/slate.js"></script>
<meta charset="UTF-8">
<meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0" name="viewport">
</head>
<body>
<h1 class=" title">Gears 1.0</h1>
<form>
<div class=" item-container">
<div class=" item-container-header">
Default Configurations
</div>
<div class=" item-container-content">
<label class=" item">&nbsp;<select id="DEFAULTS" class="OptionUpdate item-select" name="DEFAULTS" dir="rtl"><option class="item-select-option" value="" selected="TRUE">Choose a default configuration</option>
<option class="item-select-option" value="000000|FFFF00|1|FFFFFF|FFFFFF|1|0000AA|005500|FFFFFF|FFFF00|FFFFFF|FFFF00|0|FFFFFF|EN">Blue/Green on Black</option>
<option class="item-select-option" value="000000|FFFF00|1|000000|000000|1|FFFFFF|FFFFFF|555555|000055|555555|005500|1|FFFF00|EN">White on Black</option>
<option class="item-select-option" value="FFFFFF|FF0000|1|AAAAAA|AAAAAA|1|000000|000000|AAAAAA|FFFFFF|AAAAAA|FFFFFF|1|0000FF|EN">Black on White</option>
<option class="item-select-option" value="000000|FFFF00|1|AAAAAA|AAAAAA|0|000000|000000|AAAAAA|FFFF00|AAAAAA|FFFF00|1|FF00FF|EN">Yellow/Pink on Black</option>
</select></label>

</div><div class=" item-container-footer">
To save or load a custom configuration string, scroll to the bottom of this page.
</div>
</div>

<div class=" item-container">
<div class=" item-container-header">
Background Colors
</div>
<div class=" item-container-content">
<label class=" item">Background<input type="text" id="COLOR_BACKGROUND" class="OptionUpdate item-color item-color-normal" name="COLOR_BACKGROUND" value="#000000"></label>
<label class=" item">Middle Dot<input type="text" id="COLOR_DOT" class="OptionUpdate item-color item-color-normal" name="COLOR_DOT" value="#FFFF00"></label>

</div></div>

<div class=" item-container">
<div class=" item-container-header">
Dial Ticks
</div>
<div class=" item-container-content">
<label class=" item">Show Ticks?<input type="checkbox" id="SHOW_TICKS" class="OptionUpdate item-toggle" name="SHOW_TICKS" value="1"></label>
<div id="TICKS_CONTAINER">
<label class=" item">Hour Ticks<input type="text" id="COLOR_TICKS_HOUR" class="OptionUpdate item-color item-color-normal" name="COLOR_TICKS_HOUR" value="#FFFFFF"></label>
<label class=" item">Minute Ticks<input type="text" id="COLOR_TICKS_MIN" class="OptionUpdate item-color item-color-normal" name="COLOR_TICKS_MIN" value="#FFFFFF"></label>

</div>
</div></div>

<div class=" item-container">
<div class=" item-container-header">
Dial Background Colors
</div>
<div class=" item-container-content">
<label class=" item">Background Colors?<input type="checkbox" id="SHOW_DIALS" class="OptionUpdate item-toggle" name="SHOW_DIALS" value="1"></label>
<div id="DIALS_CONTAINER">
<label class=" item">Hour Gear<input type="text" id="COLOR_DIAL_HOUR" class="OptionUpdate item-color item-color-normal" name="COLOR_DIAL_HOUR" value="#0000AA"></label>
<label class=" item">Minute Gear<input type="text" id="COLOR_DIAL_MIN" class="OptionUpdate item-color item-color-normal" name="COLOR_DIAL_MIN" value="#005500"></label>

</div>
</div></div>

<div class=" item-container">
<div class=" item-container-header">
Time Colors
</div>
<div class=" item-container-content">
<label class=" item">Hours Color<input type="text" id="COLOR_NUM_HOUR" class="OptionUpdate item-color item-color-normal" name="COLOR_NUM_HOUR" value="#FFFFFF"></label>
<label class=" item">Current Hour Color<input type="text" id="COLOR_NUM_CUR_HOUR" class="OptionUpdate item-color item-color-normal" name="COLOR_NUM_CUR_HOUR" value="#FFFF00"></label>
<label class=" item">Minute Color<input type="text" id="COLOR_NUM_MIN" class="OptionUpdate item-color item-color-normal" name="COLOR_NUM_MIN" value="#FFFFFF"></label>
<label class=" item">Current Minute Color<input type="text" id="COLOR_NUM_CUR_MIN" class="OptionUpdate item-color item-color-normal" name="COLOR_NUM_CUR_MIN" value="#FFFF00"></label>

</div></div>

<div class=" item-container">
<div class=" item-container-header">
Date
</div>
<div class=" item-container-content">
<label class=" item">Show Date?<input type="checkbox" id="SHOW_DATE" class="OptionUpdate item-toggle" name="SHOW_DATE" value="1"></label>
<div id="DATE_CONTAINER">
<label class=" item">Date Color<input type="text" id="COLOR_DATE" class="OptionUpdate item-color item-color-normal" name="COLOR_DATE" value="#FFFFFF"></label>
<label class=" item">Language<select id="LOCALE" class="OptionUpdate item-select" name="LOCALE" dir="rtl"><option class="item-select-option" value="EN">EN</option>
<option class="item-select-option" value="FR">FR</option>
<option class="item-select-option" value="DE">DE</option>
<option class="item-select-option" value="ES">ES</option>
<option class="item-select-option" value="IT">IT</option>
<option class="item-select-option" value="NL">NL</option>
<option class="item-select-option" value="TR">TR</option>
<option class="item-select-option" value="CZ">CZ</option>
<option class="item-select-option" value="PT">PT</option>
<option class="item-select-option" value="CA">CA</option>
<option class="item-select-option" value="NO">NO</option>
<option class="item-select-option" value="EU">EU</option>
<option class="item-select-option" value="FI">FI</option>
<option class="item-select-option" value="DA">DA</option>
</select></label>

</div>
</div></div>

<div class="item-container">
<div class="button-container">
<input type="button" class="item-button" style="width: 40%;" name="BUTTON_SUBMIT" value="UPDATE"> <input type="button" class="item-button" style="width: 40%;" name="BUTTON_CANCEL" value="CANCEL">
</div>
</div>
<div class=" item-container">
<div class=" item-container-header">
Custom Configuration String
</div>
<div class=" item-container-content">
<textarea readonly="" id="CONFIG_STRING" value="" style="padding: 10px; width: 100%; height: 100%; background: transparent; resize: none; padding: 0; border: none; outline: none; boxshadow: none;"></textarea>
</div></div>

<div class="item-container">
<div class="button-container">
<input type="button" class="item-button" style="width: 40%;" name="BUTTON_COPY" value="COPY"> <input type="button" class="item-button" style="width: 40%;" name="BUTTON_PASTE" value="PASTE">
</div>
</div>
</form>
</body>
</html>
<style>
	BODY { padding: 5px; }	
	
	#CONFIG_STRING {
	    -webkit-touch-callout: text;
	    -webkit-user-select: text;
	    -khtml-user-select: text;
	    -moz-user-select: text;
	    -ms-user-select: text;
	    user-select: text;
	}
	
</style>
<script language="javascript">

	function ToggleSubSection(ValueSelector, ContainerSelector)
	{
		if ($(ValueSelector).is(':checked')) $(ContainerSelector).show();
		else $(ContainerSelector).hide();
	}

	function saveOptions() 
	{
		var options = {
			'KEY_CONFIG': FormatConfigString() + '|'
		};
		return options;
	}

	function FormatConfigString()
	{
		// SHOW_SECONDS|COLOR_BACKGROUND|COLOR_OUTSIDE_SEGMENTS|COLOR_HOUR_ARC|COLOR_MINUTE_ARC|COLOR_SECOND_ARC

		var ConfigArray = []; 

		ConfigArray[0] = $("#COLOR_BACKGROUND").val().substring(1);
		ConfigArray[1] = $("#COLOR_DOT").val().substring(1);
		ConfigArray[2] = Number($("#SHOW_TICKS").is(':checked'));
		ConfigArray[3] = $("#COLOR_TICKS_HOUR").val().substring(1);
		ConfigArray[4] = $("#COLOR_TICKS_MIN").val().substring(1);
		ConfigArray[5] = Number($("#SHOW_DIALS").is(':checked'));
		ConfigArray[6] = $("#COLOR_DIAL_HOUR").val().substring(1);
		ConfigArray[7] = $("#COLOR_DIAL_MIN").val().substring(1);
		ConfigArray[8] = $("#COLOR_NUM_HOUR").val().substring(1);
		ConfigArray[9] = $("#COLOR_NUM_CUR_HOUR").val().substring(1);
		ConfigArray[10] = $("#COLOR_NUM_MIN").val().substring(1);
		ConfigArray[11] = $("#COLOR_NUM_CUR_MIN").val().substring(1);
		ConfigArray[12] = Number($("#SHOW_DATE").is(':checked'));
		ConfigArray[13] = $("#COLOR_DATE").val().substring(1);
		ConfigArray[14] = $("#LOCALE").val();

//COLOR_BACKGROUND|COLOR_DOT|
//SHOW_TICKS|COLOR_TICKS_HOUR|COLOR_TICKS_MIN|
//SHOW_DIALS|COLOR_DIAL_HOUR|COLOR_DIAL_MIN|
//COLOR_NUM_HOUR|COLOR_NUM_CUR_HOUR|COLOR_NUM_MIN|COLOR_NUM_CUR_MIN|
//SHOW_DATE|COLOR_DATE|LOCALE

		var ConfigString = ConfigArray.join("|"); //+'|';
		return ConfigString.toUpperCase();	
	}

	function UpdateConfigString()
	{
		$("#CONFIG_STRING").val(FormatConfigString()+'_ARC-DIAL_1.1');
		//alert('update');
	}

	function LoadConfigString(UseString)
	{
		// SHOW_SECONDS|COLOR_BACKGROUND|COLOR_OUTSIDE_SEGMENTS|COLOR_HOUR_ARC|COLOR_MINUTE_ARC|COLOR_SECOND_ARC
		
		if (!UseString) return;
		console.log("UseString - " + UseString);
		
		UseString = UseString.trim();
		UseString = UseString.replace(/\n|\r/g, "");
		
		StringArray = UseString.split('_');
		UseString = StringArray[0];
		
		ConfigArray = UseString.split('|');
		if (ConfigArray)
		{
			$("#COLOR_BACKGROUND").val('#'		+ConfigArray[0]);
			$("#COLOR_DOT").val('#'				+ConfigArray[1]);
			$("#COLOR_TICKS_HOUR").val('#'		+ConfigArray[3]);
			$("#COLOR_TICKS_MIN").val('#'		+ConfigArray[4]);
			$("#COLOR_DIAL_HOUR").val('#'		+ConfigArray[6]);
			$("#COLOR_DIAL_MIN").val('#'		+ConfigArray[7]);
			$("#COLOR_NUM_HOUR").val('#'		+ConfigArray[8]);
			$("#COLOR_NUM_CUR_HOUR").val('#'	+ConfigArray[9]);
			$("#COLOR_NUM_MIN").val('#'			+ConfigArray[10]);
			$("#COLOR_NUM_CUR_MIN").val('#'		+ConfigArray[11]);
			$("#COLOR_DATE").val('#'			+ConfigArray[13]);
			$("#LOCALE").val(					 ConfigArray[14]);
			if (ConfigArray[2]!=0) $("#SHOW_TICKS").prop("checked", (ConfigArray[0]?"true":"false"));
			if (ConfigArray[5]!=0) $("#SHOW_DIALS").prop("checked", (ConfigArray[0]?"true":"false"));
			if (ConfigArray[12]!=0) $("#SHOW_DATE").prop("checked", (ConfigArray[0]?"true":"false"));
		}
		UpdateConfigString();
		$('.item-color').change();
		ToggleSubSection("#SHOW_TICKS", "#TICKS_CONTAINER");
		ToggleSubSection("#SHOW_DIALS", "#DIALS_CONTAINER");
		ToggleSubSection("#SHOW_DATE", "#DATE_CONTAINER");
	}
	
	// Something like this to get query variables.
	function getQueryParam(variable, defaultValue)
	{
		// Find all URL parameters
		var query = location.search.substring(1);
		var vars = query.split('&');
		for (var i = 0; i < vars.length; i++) 
		{
			var pair = vars[i].split('=');
			// If the query variable parameter is found, decode it to use and return it for use
			if (pair[0] === variable) 
			{
				return decodeURIComponent(pair[1]);
			}
		}
		return defaultValue || false;
	}
	
	$().ready(function()
    {
    	// SHOW OR HIDE CONFIGURATION SUBSECTIONS
    	$("#SHOW_TICKS").on('change', function()
		{			
			ToggleSubSection("#SHOW_TICKS", "#TICKS_CONTAINER");
    	});	  
    	$("#SHOW_DIALS").on('change', function()
		{			
			ToggleSubSection("#SHOW_DIALS", "#DIALS_CONTAINER");
    	});	  
    	$("#SHOW_DATE").on('change', function()
		{			
			ToggleSubSection("#SHOW_DATE", "#DATE_CONTAINER");
    	});	  


		// LOAD FORM WITH SAVED OPTION SETTINGS   	
    	if (typeof window.localStorage !== "undefined") 
    	{
    		console.log("Not undefined :)");
	    	//if (typeof window.localStorage.StackedDiscsSettings !== "undefined") 
	    	{
	    		//data = JSON.parse(window.localStorage.SecondRingSettings);
	    		//LoadConfigString(data['KEY_CONFIG']);
	    		//console.log("Load string from local storage: " + data['KEY_CONFIG']);
			
	    		var SavedString = window.localStorage.Gears10;
	    		LoadConfigString(SavedString);
	    		console.log("Load string from local storage: " + SavedString);			
			}
		}
    	
    	// INITIAL DISPLAY OF CUSTOM CONFIGUATION STRING
		UpdateConfigString();
		
		// SET FORM OPTIONS TO UPDATE CONFIG STRING WHEN CHANGED
		$(".OptionUpdate").change(function(){
			UpdateConfigString();
			//alert($(this).val());
		});

		// LOAD DEFAULT
		$('#DEFAULTS').change(function()
		{
			if ($(this).val()) 
			{
				LoadConfigString($(this).val());
				//alert($(this).val());
			}
    	});            

		$("input[name=BUTTON_SUBMIT]").click(function() 
		{
			console.log("Submit");
			var ConfigString = FormatConfigString();
			if (typeof window.localStorage !== "undefined")
			{
				window.localStorage.Gears10 = ConfigString;
			}
			console.log("String: " + ConfigString);

			// Set the return URL depending on the runtime environment
			var return_to = getQueryParam('return_to', 'pebblejs://close#');

    		console.log("Save string to local storage: " + ConfigString);				
			console.log("Return to: " + return_to);
			console.log("Parameters: " + encodeURIComponent(ConfigString));

			var return_value = JSON.stringify(saveOptions());
			loc = return_to + encodeURIComponent(return_value);
			console.log("Warping to: " + loc);
			
			//console.log(location);
			document.location = loc;
		});
		
		$("input[name=BUTTON_CANCEL]").click(function() 
		{
			console.log("Cancel");
			var return_to = getQueryParam('return_to', 'pebblejs://close#');
			document.location = return_to;
		});
		
		var copyTextareaBtn = document.querySelector('input[name=BUTTON_COPY]');
		copyTextareaBtn.addEventListener('click', function(event)
		{
			var copyTextarea = document.querySelector('#CONFIG_STRING');
			copyTextarea.select();
			
			try
			{
				var successful = document.execCommand('copy');
				if (!successful) alert('This doesn\'t work with your browser (you must copy the Configuration String manually).');
				//var msg = successful ? 'successful' : 'unsuccessful';
				//console.log('Copying text command was ' + msg);
			}
			catch (err) 
			{
				console.log('Oops, unable to copy');
			}
		});
		
		$("input[name=BUTTON_PASTE]").click(function() 
		{
			var PasteString = prompt("Please paste a custom configuration string", "");
		    if (PasteString != null) LoadConfigString(PasteString);
		});
		
	});

</script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-64921467-5', 'auto');
  ga('send', 'pageview');
</script>