<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <link rel="stylesheet" href="/code.jquery.com/mobile/1.3.2/jquery.css">
    <script src="/code.jquery.com//jquery-1.js"></script>
    <script src="/code.jquery.com/mobile/1.3.2/jquery.js"></script>
    <title>Configuration: Big Digits with Second Pad</title>
  </head>

  <body>
    <div data-role="page" id="page1">
      <div data-theme="" data-role="header">
	<h3>Configuration</h3>
      </div>
      <div data-role="content">
	<h2>Settings</h2>
	<div data-role="fieldcontain">
	  <label for="background">Background Color</label>
	  <select name="background" id="background" data-theme="" data-role="slider">
	    <option value="white">White</option>
	    <option value="black">Black</option>
		</select>
	</div>
	<div data-role="fieldcontain">
	  <label for="zeropad">Add leading zero</label>
	  <select name="zeropad" id="zeropad" data-theme="" data-role="slider">
	    <option value="yes">Yes</option>
	    <option value="no">No</option>
	  </select>
	</div>

	<li data-role="fieldcontain">
				<label for="battery" class="select">Show battery:</label>
				<select name="battery" id="battery">
					<option value="show">Show</option>
					<option value="1">Hide</option>
					<option value="2">only if low or charging</option>
				</select>
	</li>	
<!--	<div data-role="fieldcontain">
	  <label for="battery">Show battery</label>
	  <select name="battery" id="battery" data-theme="" data-role="slider">
	    <option value="show">Show</option>
	    <option value="hide">Hide</option>
	  </select>
	</div> -->
	<div data-role="fieldcontain">
	  <label for="connect">Show Connection status</label>
	  <select name="connect" id="connect" data-theme="" data-role="slider">
	    <option value="yes">Show</option>
	    <option value="no">Hide</option>
	  </select>
	</div>

	<li data-role="fieldcontain">
				<label for="buzzdis" class="select">Buzz on losing communication:</label>
				<select name="buzzdis" id="buzzdis">
					<option value="0">None</option>
					<option value="1">Single</option>
					<option value="2">Double</option>
					<option value="3">Long</option>
				</select>
	</li>	
	<li data-role="fieldcontain">
				<label for="buzzcon" class="select">Buzz on resuming communication:</label>
				<select name="buzzcon" id="buzzcon">
					<option value="0">None</option>
					<option value="1">Single</option>
					<option value="2">Double</option>
					<option value="3">Long</option>
				</select>
	</li>	
	<li data-role="fieldcontain">
				<label for="sec" class="select">update SecBar every x sec(save powers):</label>
				<select name="sec" id="sec">
					<option value="1">all</option>
					<option value="2">even</option>
					<option value="3">3rd</option>
					<option value="5">five</option>
					<option value="9">Never(hide it)</option>
					<option value="8">fast/slow 15 min</option>
				</select>
	</li>
	<li data-role="fieldcontain">
				<label for="face" class="select">Replace big-digits time-date-day:</label>
				<select name="face" id="face">
					<option value="1">Only Big Digit</option>
					<option value="2">Only Time/Day/Date</option>
					<option value="3">Shake to swap during first 2 sec</option>
					<option value="4">Shake to swap any time</option>
					<option value="5">Shake for two seconds of swap</option>
				</select>
	</li>
	<li data-role="fieldcontain">
				<label for="wyear" class="select">2nd date Line:</label>
				<select name="wyear" id="wyear">
					<option value="0">None</option>
					<option value="1">Week and year</option>
				</select>
	</li>
	<h4>Only in new version 1.6</h4>
	<li data-role="fieldcontain">
				<label for="option4" class="select">Be Early:</label>
				<select name="option4" id="option4">
					<option value="0">Normal</option>
					<option value="2">2 minute early</option>
					<option value="5">5 minute early</option>
				</select>
	</li>
	<div class="ui-body ui-body-b">
	  <fieldset class="ui-grid-a">
	    <div class="ui-block-a"><button type="submit" data-theme="d" id="b-cancel">Cancel</button></div>
	    <div class="ui-block-b"><button type="submit" data-theme="a" id="b-submit">Submit</button></div>
	  </fieldset>
	</div>
    <script>
      <!-- from http://snipplr.com/view/26662/get-url-parameters-with-jquery--improved/ -->
      $.urlParam = function(name){
	var results = new RegExp('[\\?&]' + name + '=([^&#]*)').exec(window.location.href);
	if (!results) { return 0; }
	return results[1] || 0;
      }

      function updateControls() {
        var background = decodeURIComponent($.urlParam("background"));
        if (background != '') {
          $("#background").val(background).slider("refresh");
        }
        var zeropad = decodeURIComponent($.urlParam("zeropad"));
        if (zeropad != '') {
          $("#zeropad").val(zeropad).slider("refresh");
        }
        var sec = decodeURIComponent($.urlParam("sec"));
        if (sec != '') {
		  $('#sec').val(sec).selectmenu('refresh');
        }
        var battery = decodeURIComponent($.urlParam("battery"));
        if (battery != '') {
		  $('#battery').val(battery).selectmenu('refresh');
        }
        var connect = decodeURIComponent($.urlParam("connect"));
        if (connect != '') {
          $("#connect").val(connect).slider("refresh");
        }
        var buzzdis = decodeURIComponent($.urlParam("buzzdis"));
        if (buzzdis != '') {
		  $('#buzzdis').val(buzzdis).selectmenu('refresh');
        }         
		var buzzcon = decodeURIComponent($.urlParam("buzzcon"));
        if (buzzcon != '') {
		  $('#buzzcon').val(buzzcon).selectmenu('refresh');
        }
		var face = decodeURIComponent($.urlParam("face"));
        if (face != '') {
		  $('#face').val(face).selectmenu('refresh');
        }
		var wyear = decodeURIComponent($.urlParam("wyear"));
        if (wyear != '') {
		  $('#wyear').val(wyear).selectmenu('refresh');
        }
		var option4 = decodeURIComponent($.urlParam("option4"));
        if (option4 != '') {
		  $('#option4').val(option4).selectmenu('refresh');
        }

     }


      function saveOptions() {
        var options = {
          'background': $("#background").val(),
          'zeropad': $("#zeropad").val(),
          'sec'    : $("#sec").val(),
          'battery': $("#battery").val(),
          'connect': $("#connect").val(),
          'buzzdis': $("#buzzdis").attr("selected",true).val(),
          'buzzcon': $("#buzzcon").attr("selected",true).val(),
          'face':    $("#face").attr("selected",true).val(),
          'wyear':   $("#wyear").attr("selected",true).val(),
          'option4':   $("#option4").attr("selected",true).val()
	  }
        return options;
      }

      $().ready(function() {
        $("#b-cancel").click(function() {
          console.log("Cancel");
          document.location = "pebblejs://close#";
        });

        $("#b-submit").click(function() {
          console.log("Submit");

          var location = "pebblejs://close#" + encodeURIComponent(JSON.stringify(saveOptions()));
          console.log(location);
          document.location = location;
        });
      });

      $('#page1').bind('pageinit', updateControls);
    </script>
  </div></div></body>
</html>
