(function(){var a={getDomStructure:function(a){var b=[];var c=a.target||a.srcElement||a;while(c.parentNode!=null){var d=0;var e=0;for(var f=0;f<c.parentNode.childNodes.length;f++){var g=c.parentNode.childNodes[f];if(g.nodeName==c.nodeName){if(g===c){e=d}d++}}if(d>1&&e>0){b.unshift(c.nodeName.toLowerCase()+":nth-of-type("+(e+1)+")")}else{b.unshift(c.nodeName.toLowerCase())}c=c.parentNode}return b.slice(1).join(" > ")},generateId:function(a){var b="";var c="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var d=0;d<a;d++)b+=c.charAt(Math.floor(Math.random()*c.length));return b},getElementOffset:function(a){if(typeof a.getBoundingClientRect==="function"){return a.getBoundingClientRect()}else{return{top:0,left:0}}},getMouseButtonPressed:function(a){var b;if(a.which==null){b=a.button<2?"left":a.button==4?"middle":"right"}else{b=a.which<2?"left":a.which==2?"middle":"right"}return b}};function b(){var a={},b=[];var c=location.search.substr(1).split("&");for(var d=0;d<c.length;d++){b=c[d].split("=");var e=decodeURIComponent(b[1]);if(e!=="undefined"){a[b[0]]=e}else if(b[0]!=""){a[b[0]]=""}}return a}function c(a){var b=new v;b.setApiVersion(l.version);b.setTrackerFunction("userInfo");b.send({ua:o.user.agent,filter_types:a},function(a){var a=JSON.parse(a);if(a["success"]){o.serverInfo=a["results"]}})}function d(){var a=navigator.userAgent;var b={iphone:Boolean(a.match(/iPhone/)),ipod:Boolean(a.match(/iPod/)),ipad:Boolean(a.match(/iPad/)),blackberry:Boolean(a.match(/BlackBerry/)),playbook:Boolean(a.match(/PlayBook/)),android:Boolean(a.match(/Android/)),wphone:Boolean(a.match(/(Windows Phone OS|Windows CE|Windows Mobile)/)),mobile:Boolean(a.match(/Mobile/)),androidTablet:Boolean(a.match(/(GT-P1000|SGH-T849|SHW-M180S)/)),tabletPc:Boolean(a.match(/Tablet PC/)),palmDevice:Boolean(a.match(/(PalmOS|PalmSource| Pre\/)/)),kindle:Boolean(a.match(/(Kindle)/)),otherMobileHints:Boolean(a.match(/(Opera Mini|IEMobile|SonyEricsson|smartphone)/))};var c=function(){return b.iphone||b.ipod||b.ipad||b.tabletPc||b.playbook||b.androidTablet||b.kindle||b.blackberry||b.android||b.palmDevice};return c()}function e(a){for(var b in a){if(a.hasOwnProperty(b)){f(b,m,a[b])}}}function f(a,b){var c=[].slice.call(arguments).splice(2);var d=a.split(".");var e=d.pop();for(var f=0;f<d.length;f++){b=b[d[f]]}return b[e].apply(this,c)}function g(a,b){if(l.debug){switch(b){case"initial":console.log("%c Concurra: "+a,"background: #821e53; color:white");break;case"error":console.log("%c Concurra: "+a,"background: #d1d1d1; color:red");break;case"success":default:console.log("%c Concurra: "+a,"color: #821e53")}}}function h(){var b=new i("concurra_visitor");if(b.read()==null){var c=a.generateId(10);b.set(JSON.stringify({date:Math.round(+new Date/1e3),visitor_id:c}),60*24*1e4);o.user.new=true;o.user.id=c}else{o.user.id=JSON.parse(b.read())["visitor_id"];if(typeof o.user.id==="undefined"||o.user.id===null){o.user.id=a.generateId(10)}o.user.new=false}}function i(a){this.name=a}i.prototype={set:function(a,b){if(b){var c;var d=new Date;d.setTime(d.getTime()+b*60*1e3);c="; expires="+d.toUTCString()}else{c=""}document.cookie=this.name+"="+a+c+"; path=/"},read:function(){var a=this.name+"=";var b=document.cookie.split(";");for(var c=0;c<b.length;c++){var d=b[c];while(d.charAt(0)==" ")d=d.substring(1,d.length);if(d.indexOf(a)==0)return d.substring(a.length,d.length)}return null},erase:function(){this.set("",-1)}};var j=function(){var b=new i("session"),c=null;function d(){c=a.generateId(10);var d={id:c,activity:Math.round(+new Date/1e3)};b.set(JSON.stringify(d),10)}function e(){var a=JSON.parse(b.read());a.activity=Math.round(+new Date/1e3);c=a.id;b.set(JSON.stringify(a),10)}if(b.read()==null){d()}return{calculate:function(){if(b.read()==null){d()}else if(JSON.parse(b.read())["activity"]<Math.round(+new Date/1e3)-60*10*3){d()}else{e()}},get:function(){this.calculate();return c}}}();!window.addEventListener&&function(a,b,c,d,e,f,g){a[d]=b[d]=c[d]=function(a,b){var c=this;g.unshift([c,a,b,function(a){a.currentTarget=c;a.preventDefault=function(){a.returnValue=false};a.stopPropagation=function(){a.cancelBubble=true};a.target=a.srcElement||c;b.call(c,a)}]);this.attachEvent("on"+a,g[0][3])};a[e]=b[e]=c[e]=function(a,b){for(var c=0,d;d=g[c];++c){if(d[0]==this&&d[1]==a&&d[2]==b){return this.detachEvent("on"+a,g.splice(c,1)[0][3])}}};a[f]=b[f]=c[f]=function(a){return this.fireEvent("on"+a.type,a)}}(Window.prototype,HTMLDocument.prototype,Element.prototype,"addEventListener","removeEventListener","dispatchEvent",[]);var k=function(){return{ready:false,send:function(){var a=new v;a.setApiVersion(l.version);if(l.trackerType==="old"){var b=setInterval(function(){if(t.ready){clearInterval(b);a.setTrackerFunction("getRequestID");a.send(o,function(a){var a=JSON.parse(a);if(a["success"]){o["request_id"]=a["results"];k.ready=true}},4e3)}},400)}else{a.setTrackerFunction("initialize");a.send(o,function(a){a=JSON.parse(a);if(a["success"]){o["request_id"]=a["results"];k.ready=true}r.request()},4e3)}}}}();var l={version:"v1",trackerType:"old",debug:false,session:j.get(),server:"https://lab.concurra.com"};if(location.hash=="#testMode"){l.server="http://lab.concurra.com"}var m={setToken:function(a){g("Using Token: "+a);o.user.token=a},setDebug:function(a){l.debug=a;g("Debug Enabled!")},setDevServer:function(a){l.server="http://lab.dev.concurra.com";g("Dev Server")}};var n;var o={uri:window.location.pathname,url_params:b(),document:{width:0,height:0},window:{height:null,width:null},resolution:{height:window.screen.height,width:window.screen.width,color:window.screen.colorDepth},user:{id:null,new:false,agent:navigator.userAgent,referrer:document.referrer.split("/")[2],language:typeof navigator.language!="undefined"?navigator.language.toLowerCase():navigator.browserLanguage.toLowerCase(),cookies:{enabled:navigator.cookieEnabled},token:null,session_id:l.session},timeline:[],hostname:location.hostname,request_id:null,experiment:{_id:null,variation:null},serverInfo:{}};var p=[];var q={spy:function(){var a=window.MutationObserver||window.WebKitMutationObserver,b=window.addEventListener;return function(c,d){if(a){var e=new a(function(a,b){if(a[0].addedNodes.length||a[0].removedNodes.length)d()});e.observe(c,{childList:true,subtree:true})}else if(b){c.addEventListener("DOMNodeInserted",d,false);c.addEventListener("DOMNodeRemoved",d,false)}}}(),spyEnabled:true};var r=function(){var b=null;var c=4e3;return{ready:false,error:null,request:function(){var a=new v;a.setApiVersion(l.version);a.setTrackerFunction("goals");a.send(o,function(a){a=JSON.parse(a);if(a.success){g("Downloaded "+a.results.length+" goal targets.");b=a.results;r.ready=true}else{g("Unable to receive goal targets: "+a.results);r.error=a.results}},c)},applyTargets:function(){var a=setInterval(function(){if(r.error!==null){u.prototype.recordLanding(document.body);clearInterval(a)}if(r.ready){clearInterval(a);g("Applying Targets...");b.forEach(function(a){var b=document.querySelector(a.path);if(b===null){return}if(b.dataset!==undefined){b.dataset["concurraGoal"]=a.goal;b.dataset["concurraTarget"]=a.target}else{b.setAttribute("data-concurra-goal",a.goal);b.setAttribute("data-concurra-target",a.target)}});u.prototype.recordLanding(document.body)}},10)},checkForConversion:function(c){var d=a.getDomStructure(c);var e,f;if(c.dataset!==undefined){e=c.dataset.concurraGoal;f=c.dataset.concurraTarget}else{if(typeof c.getAttribute==="function"){e=c.getAttribute("data-concurra-goal");f=c.getAttribute("data-concurra-target")}}if(typeof e==="undefined"&&b!==null){for(var h=0;h<b.length;h++){if(b[h].path==d){e=b[h].goal;f=b[h].target}}}if(typeof e!=="undefined"&&typeof f!=="undefined"){g("Goal found on the element, recording");return{_id:e,target:f}}return null}}}();var s=function(){var a=null;var b=2e3;return{start:function(){if(document.readyState==="complete"){return true}a=setTimeout(function(){s.stop()},b);var c=document.getElementsByTagName("body")[0];var d=document.createElement("style");d.setAttribute("id","__concurra_pop_block");d.setAttribute("type","text/css");d.innerHTML="body{opacity: 0 !important; background: white !important;}";document.head.appendChild(d)},stop:function(){clearTimeout(a);var b=document.getElementById("__concurra_pop_block");if(b){b.remove=="function"?b.remove():b.outerHTML=""}}}}();var t=function(){var a=null;var b=4e3;return{ready:false,error:null,request:function(){var c=new v;c.setApiVersion(l.version);u.prototype.recordLanding("document.body");c.setTrackerFunction("variations");c.send(o,function(b){g("Variation Received!");b=JSON.parse(b);if(!b.success){g("Error downloading variation: ","error");g(b.results,"error");t.error=true}else{a=b.results;t.error=false;t.ready=true;r.request()}},b)},apply:function(){g("Applying Variation...");var b=setInterval(function(){if(t.error===true){clearInterval(b);s.stop()}if(t.ready){clearInterval(b);if(a!==null){a.modifications.forEach(function(a){var b=document.querySelector(a.path);if(b===null){g("Unable to locate element for modification! Aborting...","error");return}switch(a.type){case"html":b.innerHTML=a.html;break;case"text":if("textContent"in b){b.textContent=a.text}else{b.innerText=a.text}break;case"remove":b.style.display="none";break;case"font":b.style.fontSize=a.change;if(b.style.setProperty){b.style.setProperty("font-size",a.change,"important")}break;case"font-weight":b.style.fontWeight=a.change;if(b.style.setProperty){b.style.setProperty("font-weight",a.change,"important")}break;case"font-style":b.style.fontStyle=a.change;if(b.style.setProperty){b.style.setProperty("font-style",a.change,"important")}break;case"font-decoration":b.style.textDecoration=a.change;if(b.style.setProperty){b.style.setProperty("text-decoration",a.change,"important")}break;case"font-family":b.style.fontFamily=a.change;if(b.style.setProperty){b.style.setProperty("font-family",a.change,"important")}break;case"color":b.style.color=a.change;if(b.style.setProperty){b.style.setProperty("color",a.change,"important")}break;case"background-color":b.style.backgroundColor=a.change;if(b.style.setProperty){b.style.setProperty("background-color",a.change,"important")}break;case"position":b.style.position=a.change;if(b.style.setProperty){b.style.setProperty("position",a.change,"important")}break;case"top":b.style.top=a.change;if(b.style.setProperty){b.style.setProperty("top",a.change,"important")}break;case"left":b.style.left=a.change;if(b.style.setProperty){b.style.setProperty("left",a.change,"important")}break;case"set-image-width":b.width=parseInt(a.change);b.style.cssText+="width:"+a.change+" !important;";break;case"set-image-height":b.height=parseInt(a.change);b.style.cssText+="height:"+a.change+" !important;";break;case"new-text-box":var c="<concurra-element><p>"+a.change+"</p></concurra-element>";b.insertAdjacentHTML("beforeBegin",c);break;case"new-html":var c="<concurra-element><div>"+a.change+"</div></concurra-element>";b.insertAdjacentHTML("beforeBegin",c);break;case"add-image":var d=document.createElement("img");d.src=a.change;d.style.position="absolute";d.style.width="auto";d.style.left=a.positionX;d.style.top=a.positionY;b.appendChild(d);b.style.position="relative";break;case"add-css":var e=document.querySelector("head");var f=document.querySelector("[__concurra_style]");if(f){f.textContent=a.change}else{f=document.createElement("style");f.type="text/css";f.setAttribute("__concurra_style","");f.appendChild(document.createTextNode(a.change))}e.appendChild(f);break;case"add-js":var e=document.querySelector("head");var h=document.querySelector("[__concurra_custom_js]");if(h){h.textContent=a.change}else{h=document.createElement("script");h.setAttribute("__concurra_custom_js","");h.appendChild(document.createTextNode(a.change))}e.appendChild(h);break;case"set-zindex":b.style.zIndex=a.change;break;case"remove-link":var i=document.createElement("P");b.parentNode.insertBefore(i.appendChild(document.createTextNode(b.textContent)),b);b.remove=="function"?b.remove():b.outerHTML="";break;case"update-url":var j=JSON.parse(a.change);if(j.href)b.href=j.href;if(j.title)b.title=j.title;if(j.target)b.target=j.target;if(j.text)b.innerHTML=j.text;break;case"update-src":var j=JSON.parse(a.change);if(j.src)b.src=j.src;break;case"new-url":var k=document.createElement("A");var j=JSON.parse(a.change);k.href=j.href;k.setAttribute("data-original",j.href);if(j.title)k.title=j.title;if(j.target)k.target=j.target;if(b.textContent){var l=document.createTextNode(b.textContent);b.textContent="";k.appendChild(l);b.appendChild(k)}else{b.parentElement.insertBefore(k,b);k.appendChild(b)}break;default:}})}else{g("No experiment is running on this page. Nothing to apply.")}s.stop()}},10)}}}();function u(){o.window.width=Math.max(window.innerWidth,document.body.offsetWidth,document.documentElement.clientWidth);o.window.height=Math.max(window.innerHeight,document.body.offsetHeight,document.documentElement.clientHeight);o.document.height=Math.max(window.innerHeight,document.body.offsetHeight,document.documentElement.scrollHeight);o.document.width=Math.max(window.innerWidth,document.body.offsetWidth,document.documentElement.clientWidth)}u.prototype={sent:false,timers:{hover:null,click:null,scroll:null},intervals:{selection:null},lastSelection:"",recordedX:0,recordedY:0,prevEvent:"",zooming:false,prevZoom:"",prevTarget:{target:"",firstEnter:"",lastEnter:""},mouseoverElements:["a","select","option","button","menu","menuitem","time"],logEvent:function(a){if(a.type!=="window.scroll"&&a.type!=="typing"){if(a.multiplier.top>=1||a.multiplier.left>=1){g("Multiplier is greater then 1, correcting...");a.multiplier.left=0;a.multiplier.top=0;a.multiplier.corrected=true}if(a.multiplier.top<0||isNaN(a.multiplier.top)){g("Invalid top multiplier, correcting...");a.multiplier.top=0;a.multiplier.corrected=true}if(a.multiplier.left<0||isNaN(a.multiplier.left)){g("Invalid left multiplier, correcting...");a.multiplier.left=0;a.multiplier.corrected=true}}o.timeline.push(a)},recordCustomHover:function(a){a.type="mouse.hover";this.logEvent(a);g("Recorded mouse hover at "+a.x+", "+a.y)},recordMouseHover:function(a){var b=this.getEventStats(a);b.type="mouse.hover";this.recordedX=b.x;this.recordedY=b.y;this.prevEvent=a;this.prevTarget.target=a.target;this.logEvent(b);g("Recorded mouse hover at "+b.x+", "+b.y)},recordMouseDown:function(a){this.recordMouseHover(a);var b=this.getEventStats(a);b.type="mouse.down";this.logEvent(b);g("Recorded mouse down at "+b.x+", "+b.y)},recordMouseMove:function(b){var c=this.getEventStats(b);c.path=a.getDomStructure(b);if(this.recordedX==c.x&&this.recordedY==c.y){return}if(b.touches.length>=2){var d=Math.abs(window.orientation)==90?screen.height:screen.width;var e=d/window.innerWidth;if(e!=this.prevZoom){this.zooming=true;c.type="mouse.zoom";c.x=window.scrollX;c.y=window.scrollY;c.zoom=e;this.prevZoom=e;this.logEvent(c);g("Recorded mouse zoom at "+c.x+", "+c.y+", x "+e);return}if(this.zooming){g("Skip move. Zooming detected");return}}c.type="mouse.move";this.recordedX=c.x;this.recordedY=c.y;this.prevEvent=b;this.prevTarget.target=b.target;var f=o.timeline[o.timeline.length-1];if(f.path!=c.path){this.recordCustomHover(c)}this.logEvent(c);g("Recorded mouse move at "+c.x+", "+c.y)},recordMouseUp:function(a){var b=this.getEventStats(a);this.zooming=false;b.type="mouse.up";this.recordedX=b.x;this.recordedY=b.y;this.prevEvent=a;this.prevTarget.target=a.target;var c=o.timeline[o.timeline.length-1];var d=o.timeline[o.timeline.length-3];if(c.type=="mouse.down"){if(d&&d.type=="mouse.click"){if(d.x<b.x+5&&d.x>b.x-5&&(d.y<b.y+5&&d.y>b.y-5)){o.timeline[o.timeline.length-3].type="mouse.dbclick";delete o.timeline[o.timeline.length-2];delete o.timeline[o.timeline.length-1];o.timeline.length=o.timeline.length-2;g("Recorded mouse dbclick at "+b.x+", "+b.y);return}}o.timeline[o.timeline.length-1].type="mouse.click";g("Recorded mouse click by prew action at "+b.x+", "+b.y);return}this.logEvent(b);g("Recorded mouse up at "+b.x+", "+b.y)},recordMouseClick:function(a){var b=this.getEventStats(a);b.type="mouse.click";this.logEvent(b);g("Recorded mouse click at "+b.x+", "+b.y)},recordLanding:function(a){var b=this.getDefaultStats(a);b.type="landing";this.logEvent(b);g("Recorded landing")},recordFormSubmit:function(a){var b=this.getDefaultStats(a.target||a.srcElement);b.type="form";this.logEvent(b);g("Recorded form submit")},recordTyping:function(a,b){var c=this.getDefaultStats(b);c.type="typing";c.data={length:a};this.logEvent(c);g("Recorded typing in "+c.path)},recordSelectionChange:function(b){var c=this.getEventStats(b);c.type="mouse.selection";var d=window.getSelection();if(d.rangeCount>0){var e=d.getRangeAt(0);var f=e.cloneContents();var h=document.createElement("div");var i=e.commonAncestorContainer.nodeName=="#text"?e.commonAncestorContainer.parentNode:e.commonAncestorContainer;var j=a.getDomStructure(i);i=i.cloneNode(true);i.appendChild(f);h.appendChild(i);var k=h.innerHTML;if(k!=this.lastSelection){c.data={selection:d,parentNode:j};this.lastSelection=k;this.prevTarget.target="";this.calcElementHover();this.logEvent(c);g("Recorded mouse selection")}}},recordWindowScroll:function(){var a;var b;if(window.pageXOffset||window.pageYOffset){a=window.pageXOffset;b=window.pageYOffset}else{a=document.documentElement.scrollLeft;b=document.documentElement.scrollTop}var c=document.documentElement.clientWidth||window.innerWidth;var d=document.documentElement.clientHeight||window.innerHeight;this.logEvent({type:"window.scroll",left:a,top:b,right:a+c,bottom:b+d,time:Math.round(+new Date/1e3)});g("Recorded window scroll at horizontal: "+a+c+", vertical: "+(b+d))},calcElementHover:function(){var a=this.getEventStats(this.prevEvent);a.type="mouse.hover";this.prevTarget.lastEnter=a;var b=this.prevEvent.target;if(this.prevTarget.firstEnter){var c=this.prevTarget.firstEnter;var d=this.prevTarget.lastEnter;a.pageX=a.x=Math.round((c.x+d.x)/2);a.pageY=a.y=Math.round((c.y+d.y)/2);a.multiplier.left=(parseFloat(c.multiplier.left)+parseFloat(d.multiplier.left))/2;a.multiplier.top=(parseFloat(c.multiplier.top)+parseFloat(d.multiplier.top))/2;var e=a.multiplier.top==Infinity||a.multiplier.left==Infinity;if((a.pageX!=0||a.pageY!=0)&&b!=this.prevTarget.target&&!e){this.recordCustomHover(a)}}},getDefaultStats:function(b){var c={time:Math.round(new Date/1e3),x:0,y:0,multiplier:{top:0,left:0}};if(b!==undefined){c.path=a.getDomStructure(b);var d=r.checkForConversion(b);if(d!==null){c.goal=d}}return c},getEventStats:function(b){var c=a.getElementOffset(b.target||b.srcElement);var d=b.pageY,e=b.pageX;if(b.changedTouches){d=b.changedTouches[0].pageY,e=b.changedTouches[0].pageX}var f={top:Math.round((d-window.pageYOffset-c.top)/5)*5,left:Math.round((e-window.pageXOffset-c.left)/5)*5};var g={x:Math.round(e/5)*5,y:Math.round(d/5)*5,path:a.getDomStructure(b),multiplier:i(),time:Math.round(+new Date/1e3)};if(b.changedTouches&&b.changedTouches[0].identifier>=0){g.identifier=b.changedTouches[0].identifier}var h=r.checkForConversion(b.target);if(h!==null){g.goal=h}return g;function i(){var a=c.width||c.right-c.left;var b=c.height||c.bottom-c.top;var d={};d.top=(f.top/b).toFixed(2);d.left=(f.left/a).toFixed(2);return d}},initiateSendDataListeners:function(){var a=this;var b=document.getElementsByTagName("a"),c=b.length;while(c--){var d=typeof b[c].attributes["href"]!=="undefined"?b[c].attributes["href"].value:"";if(d.length&&d.substring(0,1)!=="#"&&d.substring(0,11)!=="javascript:"){b[c].addEventListener("click",function(b){a.recordMouseClick(b);a.send();a.sent=true})}}window.addEventListener("beforeunload",function(){a.send()});window.addEventListener("unload",function(){a.send()});window.addEventListener("blur",function(){a.send()});document.addEventListener("visibilitychange",function(){if(document.hidden){a.send()}});window.addEventListener("pagehide",function(){a.send()});window.addEventListener("touchstart",function(){if(!navigator.sendBeacon){a.send()}});if(!navigator.sendBeacon){setInterval(function(){if(!a.sent){a.send()}},1e3)}},clickStates:{},releaseMouseClick:function(b){var c=this,d=function(b){if(a.getMouseButtonPressed(b)=="left"){c.recordMouseClick(b);c.timers.hover=null}};switch(b.type){case"mousedown":this.clickStates[b.target]={mousedown:true,timeout:null};break;case"mouseup":if(this.clickStates[b.target]&&this.clickStates[b.target]["mousedown"]){this.clickStates[b.target]["mousedown"]=false;this.clickStates[b.target]["timeout"]=setTimeout(function(){d(b)},100)}break;case"click":if(this.clickStates[b.target]){clearTimeout(this.clickStates[b.target]["timeout"]);delete this.clickStates[b.target]}d(b);break}},releaseTouchClick:function(b){var c=this,d=function(b){if(a.getMouseButtonPressed(b)=="left"){c.recordMouseClick(b);c.timers.hover=null}};switch(b.type){case"touchstart":if(this.clickStates[b.target]){clearTimeout(this.clickStates[b.target]["timeout"]);delete this.clickStates[b.target]}c.recordMouseDown(b);c.timers.hover=null;break;case"touchmove":if(this.clickStates[b.target]){clearTimeout(this.clickStates[b.target]["timeout"]);delete this.clickStates[b.target]}c.recordMouseMove(b);c.timers.hover=null;break;case"touchend":c.recordMouseUp(b);c.timers.hover=null;break}},initiateEventListeners:function(){var a=this;var b=setInterval(function(){if(r.error!==null){clearInterval(b)}if(r.ready){clearInterval(b);var c=document.querySelectorAll("form");for(var d=0;d<c.length;d++){c[d].addEventListener("submit",function(b){a.recordFormSubmit(b)},false)}}},10);if(!d()){g("Operation for Desktop");document.addEventListener("click",function(b){a.releaseMouseClick(b)});document.addEventListener("mousedown",function(b){a.releaseMouseClick(b)});document.addEventListener("mouseup",function(b){a.releaseMouseClick(b)});document.addEventListener("dblclick",function(b){a.recordSelectionChange(b)});document.addEventListener("mousedown",function(b){a.recordMouseHover(b);a.intervals["selection"]=setInterval(function(){b.pageX=a.pageX;b.pageY=a.pageY;a.recordSelectionChange(b)},200)});document.addEventListener("mouseup",function(b){a.recordMouseHover(b);clearInterval(a.intervals["selection"])});document.addEventListener("mousemove",function(b){clearTimeout(a.timers.hover);a.timers.hover=setTimeout(function(){a.recordMouseHover(b);a.timers.hover=null},150);setTimeout(function(){if(a.prevEvent&&a.prevEvent.target!=b.target&&a.mouseoverElements.indexOf(a.prevEvent.target.localName)!=-1){a.calcElementHover();a.prevTarget.firstEnter=a.getEventStats(b)}a.prevEvent=b},50)});window.addEventListener("scroll",function(){clearTimeout(a.timers.scroll);a.timers.scroll=setTimeout(function(){a.recordWindowScroll();a.timers.scroll=null},700)});window.addEventListener("keyup",function(b){if(b.target.nodeName==="INPUT"||b.target.nodeName==="TEXTAREA"){var c=b.target.value.length;a.recordTyping(c,b)}})}else{g("Operation for Touch devices");document.addEventListener("touchstart",function(b){a.releaseTouchClick(b);a.intervals["selection"]=setInterval(function(){b.pageX=a.pageX;b.pageY=a.pageY;a.recordSelectionChange(b)},200)});document.addEventListener("touchmove",function(b){a.releaseTouchClick(b)});document.addEventListener("touchend",function(b){a.releaseTouchClick(b);clearInterval(a.intervals["selection"])});window.addEventListener("scroll",function(b){clearTimeout(a.timers.scroll);a.timers.scroll=setTimeout(function(){a.recordWindowScroll();a.timers.scroll=null},700)});window.addEventListener("keyup",function(b){if(b.target.nodeName==="INPUT"||b.target.nodeName==="TEXTAREA"){var c=b.target.value.length;a.recordTyping(c,b)}})}},prevData:"",send:function(){if(!k.ready||this.prevData==JSON.stringify(o)){return false}p=p.concat(o.timeline);this.prevData=JSON.stringify(o);var a=j.get();if(a!==o.user.session_id){o.user.expired_session_id=l.session;o.user.session_id=a}g("Tracker is sending data to Concurra...");g("Using sendBeacon method.");if(!navigator||!navigator.sendBeacon||!navigator.sendBeacon(l.server+"/api/tracker/"+l.version+"/log/",JSON.stringify(o))){g("sendBeacon method not supported. Falling back to standard XHR request.");var b=new v;b.setApiVersion(l.version);b.send(o,function(a){g(a);C(o)},2e3)}else{C(o)}o.timeline=[];this.prevData=""},start:function(){var a=setInterval(function(){if(typeof t==="undefined"||t.ready){clearInterval(a);this.initiateSendDataListeners();this.initiateEventListeners()}}.bind(this),100)}};function v(){this.version="v1";this.function="log";this.time=(new Date).getTime();this.setApiVersion=function(a){this.version=a};this.setTrackerFunction=function(a){this.function=a};this.send=function(b,c,d){var e=l.server+"/api/tracker/"+this.version+"/"+this.function+"/"+"?t="+this.time;var f=false;if(d!==undefined){f=true}var h=a("POST",e,f);if(!h){g("Unable to connect to Concurra! Your data may not have been saved.");return}h.onload=function(){if(c!=null){c(h.responseText)}};if(d!==undefined){h.ontimeout=function(){g("Timed out trying to connect to Concurra's servers!","error")};h.timeout=d}h.onerror=function(){g("Error sending request to Concurra! Your data may not have been saved.")};h.setRequestHeader("Content-Type","application/x-www-form-urlencoded");try{h.send(JSON.stringify(b))}catch(i){g(i)}C(b)};function a(a,b,c){var d=new XMLHttpRequest;if("withCredentials"in d){d.open(a,b,c);if(c){d.withCredentials=true}}else if(typeof XDomainRequest!="undefined"){d=new XDomainRequest;d.open(a,b)}else{d=null}return d}}var w=window.location!=window.parent.location&&window.self!==window.top;if(typeof s!=="undefined"&&!w&&document.readyState!=="complete"){s.start()}function x(){if(typeof __concurra_queue!=="undefined"){clearInterval(y);clearTimeout(z);e(__concurra_queue);__concurra_queue={};g("Tracking Program (c) 2015","initial");B();return true}return false}if(!x()){var y=setInterval(x,500)}var z=setTimeout(function(){clearInterval(y)},5e3);var A=navigator.userAgent.toLowerCase().indexOf("concurra hidden")!==-1;function B(){if(!w){h();if(!A){if(typeof t!=="undefined"){if(document.readyState!=="complete"){t.request()}else{t.error=true;t.ready=true;g("Variations will not be applied because page was already loaded "+"(tracker loaded asynch / installed in the bottom of the page)")}}if(l.trackerType!=="old"){k.send()}}var a=setInterval(function(){if(document.readyState==="complete"){clearInterval(a);if(typeof t!=="undefined"){q.spy(document.body,function(){if(q.spyEnabled){t.apply()}else{q.spyEnabled=true}});t.apply()}r.applyTargets();g("Document Loaded. Starting Tracking.");(new u).start();if(l.trackerType==="old"){k.send()}}},10)}else{function b(){if(document.querySelector(".system-tracker")){return}var a=document.createElement("script");a.id="concurra- tracker-modules";a.classList.add("system-tracker");a.setAttribute("src",l.server+"/tracker/system/System.min.js");document.body.appendChild(a)}if(document.readyState!="loading"){b()}else{document.addEventListener("DOMContentLoaded",b,false)}}}function C(a){a.user.expired_session_id=null;return a.user.request_id!==null?"":a.request_id=0}})();
//# sourceMappingURL=tracker.js.map